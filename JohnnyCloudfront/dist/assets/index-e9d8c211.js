import{r as u,a as fn,L as J,O as mn,u as pn,B as yn,b as wn,c as F,d as In}from"./react-vendor-cf6d7c8c.js";import{M as fe,V as Tt,a as xn,b as At,P as Sn,S as vn,X as bn}from"./ui-vendor-5be21587.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();var Rt={exports:{}},we={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cn=u,En=Symbol.for("react.element"),_n=Symbol.for("react.fragment"),kn=Object.prototype.hasOwnProperty,Tn=Cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,An={key:!0,ref:!0,__self:!0,__source:!0};function Pt(e,t,n){var s,o={},r=null,a=null;n!==void 0&&(r=""+n),t.key!==void 0&&(r=""+t.key),t.ref!==void 0&&(a=t.ref);for(s in t)kn.call(t,s)&&!An.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)o[s]===void 0&&(o[s]=t[s]);return{$$typeof:En,type:e,key:r,ref:a,props:o,_owner:Tn.current}}we.Fragment=_n;we.jsx=Pt;we.jsxs=Pt;Rt.exports=we;var i=Rt.exports,ke={},Xe=fn;ke.createRoot=Xe.createRoot,ke.hydrateRoot=Xe.hydrateRoot;const Rn="modulepreload",Pn=function(e){return"/"+e},Qe={},H=function(t,n,s){if(!n||n.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(n.map(r=>{if(r=Pn(r),r in Qe)return;Qe[r]=!0;const a=r.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(!!s)for(let m=o.length-1;m>=0;m--){const y=o[m];if(y.href===r&&(!a||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${c}`))return;const h=document.createElement("link");if(h.rel=a?"stylesheet":Rn,a||(h.as="script",h.crossOrigin=""),h.href=r,document.head.appendChild(h),a)return new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t()).catch(r=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r})};function Nn(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}async function jn(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t);return Nn(new Uint8Array(n))}function On(e=64){const t=new Uint8Array(e);crypto.getRandomValues(t);const n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~";let s="";for(let o=0;o<t.length;o++)s+=n[t[o]%n.length];return s}async function $r(){const e="https://us-east-1csm5oddde.auth.us-east-1.amazoncognito.com",t="4oc76981p9te4uegc85r0mnjg7",n=({}.VITE_SCOPES||"openid email").split(/\s+/).join("+"),s="https://d1zhi8uis2cnfs.cloudfront.net/auth/callback";console.log("🔐 handleLogin: Starting authentication"),console.log("🔐 handleLogin: Domain:",e),console.log("🔐 handleLogin: Client ID:",t),console.log("🔐 handleLogin: Redirect URI:",s);const o=On(64),r=await jn(o);sessionStorage.setItem("pkce_verifier",o);const c=`${e.startsWith("http")?e:`https://${e}`}/login?client_id=${encodeURIComponent(t)}&response_type=code&scope=${n}&redirect_uri=${encodeURIComponent(s)}&code_challenge=${encodeURIComponent(r)}&code_challenge_method=S256`;console.log("🔐 handleLogin: Redirecting to Cognito:",c),window.location.href=c}function Dn(){const e="https://us-east-1csm5oddde.auth.us-east-1.amazoncognito.com",t="4oc76981p9te4uegc85r0mnjg7",n="https://d1zhi8uis2cnfs.cloudfront.net/";localStorage.removeItem("id_token"),localStorage.removeItem("access_token");const o=`${e.startsWith("http")?e:`https://${e}`}/logout?client_id=${encodeURIComponent(t)}&logout_uri=${encodeURIComponent(n)}`;window.location.href=o}function Nt(){return localStorage.getItem("id_token")||localStorage.getItem("access_token")||""}function Mn(){const e=Nt();if(!e)return!1;try{const t=JSON.parse(atob(e.split(".")[1]));return Date.now()/1e3<t.exp}catch{return!1}}function Ln(){const e=Nt();if(!e)return{};try{const t=JSON.parse(atob(e.split(".")[1]));return{name:t.name||t.given_name||t.preferred_username,email:t.email,account:t["cognito:username"]||t.sub}}catch{return{}}}function Un(){var s;const e=Ln(),t=Mn(),n=()=>{Dn()};return i.jsx("header",{className:"sticky top-0 z-40 backdrop-blur supports-[backdrop-filter]:bg-black/30 dark:supports-[backdrop-filter]:bg-black/30 light:supports-[backdrop-filter]:bg-white/30 border-b border-primary",children:i.jsxs("div",{className:"max-w-6xl mx-auto px-4 h-14 flex items-center gap-3",children:[i.jsx(J,{to:"/",className:"font-bold text-lg",children:"JohnnyCloud"}),i.jsxs("nav",{className:"ml-4 hidden md:flex items-center gap-3 text-sm",children:[i.jsx(J,{to:"/",className:"jc-chip",children:"Home"}),i.jsx(J,{to:"/metrics",className:"jc-chip",children:"Metrics"}),i.jsx(J,{to:"/guardrails",className:"jc-chip",children:"Guardrails"}),i.jsx(J,{to:"/why-aws",className:"jc-chip",children:"Why AWS"}),i.jsx(J,{to:"/about",className:"jc-chip",children:"About"}),i.jsx(J,{to:"/faq",className:"jc-chip",children:"FAQ"})]}),i.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[i.jsx("div",{className:"hidden md:block px-2 py-1 rounded-lg bg-blue-500/10 border border-blue-500/20",children:i.jsx("span",{className:"text-xs text-blue-300",children:'Say "Johnny 5" to activate'})}),t?i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("span",{className:"px-2 py-1 rounded-xl bg-blue-500/20 text-blue-300 text-xs",children:["Signed in as ",e.name||((s=e.email)==null?void 0:s.split("@")[0])||"User"]}),i.jsx("button",{onClick:n,className:"px-3 py-1 rounded-xl bg-red-500/20 text-red-300 text-xs hover:bg-red-500/30 transition-colors",children:"Sign Out"})]}):i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(J,{to:"/login",className:"px-3 py-1 rounded-xl bg-blue-500/20 text-blue-300 text-xs hover:bg-blue-500/30 transition-colors",children:"Sign In"}),i.jsx("span",{className:"px-2 py-1 rounded-xl bg-green-500/20 text-green-300 text-xs",children:"Local Development"})]})]})]})})}function Kn(){const e=u.useRef(null),t=u.useRef(),n=u.useRef([]),s=u.useRef([]),o=u.useRef(0),r=u.useRef(0),a=u.useRef(0),c=u.useRef(0),l=u.useRef(Date.now()),h=["rgba(6, 182, 212, 1.0)","rgba(59, 130, 246, 1.0)","rgba(16, 185, 129, 1.0)"],m=["rgba(239, 68, 68, 1.0)","rgba(245, 158, 11, 1.0)"],y=u.useCallback((d,g,x=!1)=>{const S=x?m:h,_=S[Math.floor(Math.random()*S.length)];return{id:r.current++,x:d,y:g,radius:0,maxRadius:Math.random()*150+200,opacity:x?1:.9,color:_,isAnomaly:x,speed:x?.8:.5}},[]),I=u.useCallback((d,g,x=!1)=>{const S=x?m:h,_=S[Math.floor(Math.random()*S.length)];return{id:a.current++,x:d,y:g,opacity:0,maxOpacity:1,color:_,isAnomaly:x,age:0,maxAge:2e3,size:x?12:10}},[]),b=u.useCallback((d,g)=>{const x=g.radius/g.maxRadius,S=g.opacity*(1-x);S<=0||(d.save(),d.globalAlpha=S,d.strokeStyle=g.color,d.lineWidth=g.isAnomaly?3:2,d.beginPath(),d.arc(g.x,g.y,g.radius,0,Math.PI*2),d.stroke(),g.isAnomaly&&(d.globalAlpha=S*.3,d.strokeStyle=g.color,d.lineWidth=6,d.beginPath(),d.arc(g.x,g.y,g.radius,0,Math.PI*2),d.stroke()),d.globalAlpha=S*.4,d.lineWidth=1,d.beginPath(),d.arc(g.x,g.y,g.radius*.7,0,Math.PI*2),d.stroke(),d.restore())},[]),T=u.useCallback((d,g)=>{const x=g.age/g.maxAge,S=g.opacity*(1-x);S<=0||(d.save(),d.globalAlpha=S,d.shadowColor=g.color,d.shadowBlur=10,d.fillStyle=g.color,d.beginPath(),d.arc(g.x,g.y,g.size,0,Math.PI*2),d.fill(),g.isAnomaly?(d.shadowBlur=30,d.globalAlpha=S*.8,d.fillStyle=g.color,d.beginPath(),d.arc(g.x,g.y,g.size*3,0,Math.PI*2),d.fill()):(d.shadowBlur=25,d.globalAlpha=S*.6,d.fillStyle=g.color,d.beginPath(),d.arc(g.x,g.y,g.size*2.2,0,Math.PI*2),d.fill()),d.restore())},[]),K=u.useCallback((d,g,x,S)=>{d.save();const _=d.createRadialGradient(g,x,0,g,x,S);_.addColorStop(0,"rgba(6, 182, 212, 0.8)"),_.addColorStop(.2,"rgba(6, 182, 212, 0.6)"),_.addColorStop(.5,"rgba(6, 182, 212, 0.4)"),_.addColorStop(1,"rgba(6, 182, 212, 0.2)"),d.fillStyle=_,d.beginPath(),d.moveTo(g,x),d.arc(g,x,S,c.current-.2,c.current+.2),d.closePath(),d.fill(),d.strokeStyle="rgba(6, 182, 212, 1.0)",d.lineWidth=5,d.shadowColor="rgba(6, 182, 212, 1.0)",d.shadowBlur=20,d.beginPath(),d.moveTo(g,x),d.lineTo(g+Math.cos(c.current)*S,x+Math.sin(c.current)*S),d.stroke(),d.shadowBlur=0,d.fillStyle="rgba(6, 182, 212, 1.0)",d.beginPath(),d.arc(g,x,6,0,Math.PI*2),d.fill(),d.restore()},[]),v=u.useCallback(()=>{const d=e.current;if(!d)return;const g=d.getContext("2d");if(!g)return;const{width:x,height:S}=d,_=x/2,M=S/2,C=Math.min(x,S)/2,w=g.createRadialGradient(_,M,0,_,M,C);w.addColorStop(0,"rgba(15, 23, 42, 0.2)"),w.addColorStop(1,"rgba(8, 12, 20, 0.4)"),g.fillStyle=w,g.fillRect(0,0,x,S),g.strokeStyle="rgba(6, 182, 212, 0.5)",g.lineWidth=2;for(let f=50;f<C;f+=50)g.beginPath(),g.arc(_,M,f,0,Math.PI*2),g.stroke();g.strokeStyle="rgba(6, 182, 212, 0.4)",g.lineWidth=1.5;for(let f=0;f<x;f+=100)g.beginPath(),g.moveTo(f,0),g.lineTo(f,S),g.stroke();for(let f=0;f<S;f+=100)g.beginPath(),g.moveTo(0,f),g.lineTo(x,f),g.stroke();const O=Date.now()-l.current;c.current=O/12e3*Math.PI*2,K(g,_,M,C);const D=Date.now();if(D-o.current>Math.random()*3e3+3e3){const f=Math.random()<.25,p=Math.random()*Math.PI*2,k=Math.random()*(C*.8),P=_+Math.cos(p)*k,L=M+Math.sin(p)*k,W=I(P,L,f);s.current.push(W),n.current.push(y(P,L,f)),o.current=D}s.current=s.current.filter(f=>(f.age+=16,f.opacity=f.maxOpacity*(1-f.age/f.maxAge),T(g,f),f.age<f.maxAge)),n.current=n.current.filter(f=>(f.radius+=f.speed,b(g,f),f.radius<f.maxRadius)),t.current=requestAnimationFrame(v)},[y,I,b,T,K]),j=u.useCallback(()=>{const d=e.current;if(!d)return;const g=d.getBoundingClientRect();d.width=g.width,d.height=g.height},[]);return u.useEffect(()=>{j(),v();const d=()=>{j()};return window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d),t.current&&cancelAnimationFrame(t.current)}},[v,j]),i.jsx("div",{className:"cost-radar-container",children:i.jsx("canvas",{ref:e,className:"cost-radar-canvas","aria-hidden":"true"})})}function Vn(){return i.jsxs("div",{className:"min-h-dvh relative",children:[i.jsx(Kn,{}),i.jsx(Un,{}),i.jsx("main",{className:"relative mx-auto max-w-6xl px-4 py-8 md:py-10 lg:py-12",children:i.jsx(mn,{})})]})}const jt=u.createContext(void 0);function Ne(){const e=u.useContext(jt);if(e===void 0)throw new Error("useGlobalChatbot must be used within a GlobalChatbotProvider");return e}function $n({children:e}){const[t,n]=u.useState(!1),[s,o]=u.useState(!1),r=u.useCallback(()=>{n(!0),o(!0)},[]),a=u.useCallback(()=>{n(!1),o(!1),window.dispatchEvent(new CustomEvent("chatbotClosed"))},[]),c=u.useCallback(()=>{n(m=>!m),o(m=>!m)},[]),l=u.useCallback(m=>{o(m)},[]),h={isOpen:t,openChatbot:r,closeChatbot:a,toggleChatbot:c,isActivated:s,setActivated:l};return i.jsx(jt.Provider,{value:h,children:e})}function Wn({show:e,onClose:t,detectedText:n}){const[s,o]=u.useState(!1);return u.useEffect(()=>{if(e){o(!0);const r=setTimeout(()=>{o(!1),setTimeout(t,300)},3e3);return()=>clearTimeout(r)}},[e,t]),!e&&!s?null:i.jsx("div",{className:`fixed top-20 right-4 z-50 transition-all duration-300 ${s?"opacity-100 translate-x-0":"opacity-0 translate-x-full"}`,children:i.jsx("div",{className:"bg-green-500/20 border border-green-500/30 rounded-lg p-4 backdrop-blur-sm shadow-lg",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center animate-pulse",children:i.jsx(fe,{className:"w-4 h-4 text-white"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-green-300 font-medium text-sm",children:"Wake word detected!"}),n&&i.jsxs("div",{className:"text-green-200 text-xs mt-1",children:['"',n,'"']}),i.jsx("div",{className:"text-green-400 text-xs mt-1",children:"Activating Johnny-5..."})]})]})})})}function Fn({onWakeWordDetected:e,onChatbotActivated:t}){const[n,s]=u.useState(!1),[o,r]=u.useState(!1),[a,c]=u.useState(!1),[l,h]=u.useState(""),[m,y]=u.useState(!1),[I,b]=u.useState(!1),[T,K]=u.useState(""),v=u.useRef(null),j=u.useRef(null),d=u.useRef(null);u.useEffect(()=>{const C=window.SpeechRecognition||window.webkitSpeechRecognition;r(!!C)},[]),u.useEffect(()=>(typeof window<"u"&&window.AudioContext&&(d.current=new AudioContext),()=>{d.current&&d.current.close()}),[]);const g=u.useCallback(()=>{if(d.current)try{const C=d.current.createOscillator(),w=d.current.createGain();C.connect(w),w.connect(d.current.destination),C.frequency.setValueAtTime(800,d.current.currentTime),C.frequency.setValueAtTime(600,d.current.currentTime+.1),w.gain.setValueAtTime(.3,d.current.currentTime),w.gain.exponentialRampToValueAtTime(.01,d.current.currentTime+.2),C.start(d.current.currentTime),C.stop(d.current.currentTime+.2)}catch(C){console.log("Audio feedback not available:",C)}},[]),x=u.useCallback(()=>{y(!0),setTimeout(()=>y(!1),1e3)},[]),S=u.useCallback(async()=>{if(o)try{await navigator.mediaDevices.getUserMedia({audio:!0}),c(!0);const C=window.SpeechRecognition||window.webkitSpeechRecognition,w=new C;w.continuous=!0,w.interimResults=!0,w.lang="en-US",w.maxAlternatives=1,w.onstart=()=>{s(!0),console.log("🎤 Wake word listener started")},w.onresult=O=>{let D="",f="";for(let L=O.resultIndex;L<O.results.length;L++){const W=O.results[L][0].transcript;O.results[L].isFinal?D+=W:f+=W}const p=(D+f).toLowerCase();["johnny 5","johnny five","johnny5","johnny-5"].some(L=>p.includes(L))&&D&&(console.log("🎯 Wake word detected:",D),h(D),K(D),g(),x(),b(!0),window.dispatchEvent(new CustomEvent("wakeWordDetected")),e(),setTimeout(()=>{t(),window.dispatchEvent(new CustomEvent("chatbotActivated"))},500))},w.onerror=O=>{console.error("Wake word recognition error:",O.error),O.error==="not-allowed"&&(c(!1),s(!1))},w.onend=()=>{s(!1),n&&setTimeout(()=>{n&&w.start()},100)},v.current=w,w.start()}catch(C){console.error("Failed to start wake word listener:",C),c(!1)}},[o,n,e,t,g,x]),_=u.useCallback(()=>{v.current&&(v.current.stop(),v.current=null),s(!1),console.log("🎤 Wake word listener stopped")},[]),M=u.useCallback(()=>{n?_():S()},[n,S,_]);return u.useEffect(()=>{const C=w=>{w.ctrlKey&&w.key==="m"&&(w.preventDefault(),M())};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[M]),u.useEffect(()=>()=>{_(),j.current&&clearTimeout(j.current)},[_]),o?i.jsxs(i.Fragment,{children:[i.jsx(Wn,{show:I,onClose:()=>b(!1),detectedText:T}),m&&i.jsx("div",{className:"fixed inset-0 pointer-events-none z-50 flex items-center justify-center",children:i.jsx("div",{className:"bg-blue-500/20 backdrop-blur-sm rounded-full p-8 animate-pulse",children:i.jsx(Tt,{className:"w-16 h-16 text-blue-400"})})}),i.jsx("div",{className:"fixed top-4 right-4 z-40",children:i.jsxs("div",{className:"flex items-center gap-2",children:[n&&i.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-500/20 border border-green-500/30 rounded-full",children:[i.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),i.jsx("span",{className:"text-xs text-green-300",children:'Listening for "Johnny 5"'})]}),i.jsx("button",{onClick:M,className:`p-3 rounded-full transition-all duration-200 ${n?"bg-red-500 hover:bg-red-600 text-white shadow-lg shadow-red-500/50":"bg-white/10 hover:bg-white/20 text-white border border-white/20"}`,title:`${n?"Stop":"Start"} hands-free mode (Ctrl+M)`,"aria-label":`${n?"Stop":"Start"} wake word listening`,children:n?i.jsx(xn,{className:"w-5 h-5"}):i.jsx(fe,{className:"w-5 h-5"})})]})}),l&&i.jsx("div",{className:"fixed bottom-4 right-4 z-40",children:i.jsxs("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-3 backdrop-blur-sm",children:[i.jsx("div",{className:"text-xs text-blue-300 mb-1",children:"Last detected:"}),i.jsxs("div",{className:"text-sm text-white font-medium",children:['"',l,'"']})]})}),!a&&o&&i.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",children:i.jsx("div",{className:"bg-white/10 border border-white/20 rounded-2xl p-6 max-w-md mx-4 backdrop-blur-sm",children:i.jsxs("div",{className:"text-center",children:[i.jsx(fe,{className:"w-12 h-12 text-blue-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Enable Hands-Free Mode"}),i.jsx("p",{className:"text-white/70 mb-4",children:'Allow microphone access to use voice commands. Say "Johnny 5" to activate the chatbot from anywhere on the site.'}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:S,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Allow Microphone"}),i.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors",children:"Cancel"})]})]})})})]}):null}function Gn(){const e=pn(),t=s=>{switch(s){case"/":return"home";case"/metrics":return"metrics";case"/guardrails":return"guardrails";case"/why-aws":return"why-aws";case"/about":return"about";case"/faq":return"faq";default:return"unknown"}},n=s=>{switch(s){case"/metrics":return{page:"metrics",features:["cost-analysis","security-monitoring","anomaly-detection"]};case"/guardrails":return{page:"guardrails",features:["security-compliance","remediation-guidance"]};case"/why-aws":return{page:"why-aws",features:["migration-planning","cost-calculator","business-case"]};case"/about":return{page:"about",features:["team-info","company-overview"]};case"/faq":return{page:"faq",features:["help","support","documentation"]};default:return{page:"home",features:["overview","navigation","getting-started"]}}};return{pathname:e.pathname,pageName:t(e.pathname),pageContext:n(e.pathname)}}const Z="https://4z2t2pj4r4.execute-api.us-east-1.amazonaws.com/chat".replace(/\/$/,"");async function zn(e){if(!Z)throw new Error("VITE_CHAT_API not set");const t={message:e.message,mode:"bedrock",sessionId:e.sessionId,history:e.history,speak:e.speak,voice:e.voice};console.log("Chat API Request:",{url:Z,body:t});const n=await fetch(Z,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});if(console.log("Chat API Response:",{status:n.status,statusText:n.statusText,headers:Object.fromEntries(n.headers.entries())}),!n.ok){const c=await n.text().catch(()=>"");throw console.error("Chat API Error:",{status:n.status,text:c}),new Error(`API ${n.status}: ${c}`)}let s;if(s=(n.headers.get("content-type")||"").includes("application/json")?await n.json():await n.text(),console.log("Chat API Data:",s),console.log("Payload type:",typeof s),console.log("Payload keys:",typeof s=="object"?Object.keys(s):"N/A"),typeof s=="string")return s.trim();const r=(s.response??s.reply??s.message??s.output??"").toString().trim(),a=s.audio;return console.log("Extracted text:",r),console.log("Extracted audio:",a),console.log("Text length:",r.length),r?(console.log("Chat API Final Response:",r),a?{text:r,audio:a}:r):(console.warn("Empty API payload:",s),console.warn("Available keys:",typeof s=="object"?Object.keys(s):"N/A"),"[no content returned]")}async function*Bn(e){var c;if(!Z)throw new Error("VITE_CHAT_API not set");const t={message:e.message,mode:"bedrock",sessionId:e.sessionId,stream:!0,history:e.history,speak:e.speak,voice:e.voice};console.log("Chat API Stream Request:",{url:Z,body:t});const n=await fetch(Z,{method:"POST",headers:{"content-type":"application/json",accept:"text/event-stream"},body:JSON.stringify(t)});if(console.log("Chat API Stream Response:",{status:n.status,statusText:n.statusText,contentType:n.headers.get("content-type"),headers:Object.fromEntries(n.headers.entries())}),!n.ok){const l=await n.text().catch(()=>"");throw console.error("Chat API Stream Error:",{status:n.status,text:l}),new Error(`chat api ${n.status}: ${l||n.statusText}`)}if((c=n.headers.get("content-type"))!=null&&c.includes("text/event-stream")){console.log("Processing streaming response...");const l=n.body.getReader(),h=new TextDecoder;let m="";for(;;){const{value:y,done:I}=await l.read();if(I)break;m+=h.decode(y,{stream:!0});const b=m.split(`

`);m=b.pop()||"";for(const T of b){const K=T.trim();if(K.startsWith("data:")){const v=K.slice(5).trim();if(v==="[DONE]"){console.log("Stream completed with [DONE]");return}console.log("Stream chunk:",v),yield v}}}console.log("Stream completed naturally");return}console.log("Falling back to non-streaming response");let s;if(s=(n.headers.get("content-type")||"").includes("application/json")?await n.json():await n.text(),console.log("Fallback data:",s),typeof s=="string"){yield s.trim();return}const r=(s.response??s.reply??s.message??s.output??"").toString().trim(),a=s.audio;r?(console.log("Fallback response:",r),yield r,a&&(yield{type:"audio",data:a})):(console.warn("Empty fallback payload:",s),yield"[no content returned]")}async function Ye(e,t,n){try{let s="",o=null;try{for await(const r of Bn({message:e,sessionId:crypto.randomUUID(),speak:t,voice:n}))typeof r=="string"?s+=r:r&&typeof r=="object"&&r.type==="audio"&&(o=r.data)}catch{const a=await zn({message:e,sessionId:crypto.randomUUID(),speak:t,voice:n});typeof a=="string"?s=a:a&&typeof a=="object"&&(s=a.text,o=a.audio)}return{message:s,audio:o}}catch(s){throw console.error("Chat API error:",s),s}}function qn({askEndpoint:e,context:t={},onSent:n}){const[s,o]=u.useState("idle"),[r,a]=u.useState(""),[c,l]=u.useState(""),[h,m]=u.useState(!1),[y,I]=u.useState(""),b=u.useRef(null),T=u.useRef(null),K=u.useRef(null),v=u.useRef(!1),j=f=>{try{window.speechSynthesis.cancel()}catch{}if(!("speechSynthesis"in window))return;const p=new SpeechSynthesisUtterance(f);p.rate=1,p.pitch=1,p.volume=1,p.onend=()=>o("idle"),T.current=p,window.speechSynthesis.speak(p),o("speaking")},d=()=>{speechSynthesis.speaking&&!speechSynthesis.paused&&(speechSynthesis.pause(),o("paused"))},g=()=>{speechSynthesis.paused&&(speechSynthesis.resume(),o("speaking"))},x=()=>{var f,p;try{speechSynthesis.cancel()}catch{}try{(p=(f=b.current)==null?void 0:f.stop)==null||p.call(f)}catch{}clearTimeout(K.current),o("idle")};u.useEffect(()=>{const f=window.SpeechRecognition||window.webkitSpeechRecognition;v.current=!!f},[]);const S=()=>{if(!v.current){m(!0);return}x(),l("");const f=window.SpeechRecognition||window.webkitSpeechRecognition,p=new f;p.lang="en-US",p.interimResults=!0,p.continuous=!1,p.maxAlternatives=1;let k="";p.onresult=P=>{let L="";for(let W=P.resultIndex;W<P.results.length;++W){const Ce=P.results[W][0].transcript;P.results[W].isFinal?k+=Ce:L+=Ce}l(k+L)},p.onerror=P=>{console.error("Speech recognition error:",P),o("idle")},p.onend=()=>{k.trim()?M(k.trim()):o("idle")},b.current=p,p.start(),o("listening")},_=()=>{b.current&&b.current.stop()},M=async f=>{if(l(f),o("idle"),!!f)try{const k=(await Ye(f,!0)).message||"Sorry, I couldn't find an answer.";a(k),n==null||n(f,k),j(k)}catch(p){console.error("Error sending message:",p),j("Sorry, there was a problem getting the answer.")}},C=async()=>{if(!y.trim())return;const f=y.trim();I(""),m(!1);try{const k=(await Ye(f,!0)).message||"Sorry, I couldn't find an answer.";a(k),n==null||n(f,k),j(k)}catch{j("Sorry, there was a problem getting the answer.")}};u.useEffect(()=>()=>x(),[]);const w=s==="listening",O=s==="speaking",D=s==="paused";return i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("button",{onMouseDown:S,onMouseUp:_,onTouchStart:f=>{f.preventDefault(),S()},onTouchEnd:f=>{f.preventDefault(),_()},onKeyDown:f=>{f.code==="Space"&&!f.repeat&&(f.preventDefault(),S())},onKeyUp:f=>{f.code==="Space"&&(f.preventDefault(),_())},"aria-pressed":w,"aria-label":"Hold to ask JohnnyCloud",className:`relative flex items-center justify-center w-16 h-16 rounded-full transition-all duration-200 transform ${w?"bg-red-500 text-white scale-110 shadow-lg shadow-red-500/50":"bg-sky-500 text-white hover:bg-sky-400 hover:scale-105 shadow-lg shadow-sky-500/30"}`,title:"Hold to speak. Release to send. (Space bar also works)",children:[w&&i.jsx("div",{className:"absolute inset-0 rounded-full bg-red-500 animate-ping opacity-75"}),i.jsx(fe,{className:`h-6 w-6 ${w?"animate-pulse":""}`})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-sm font-medium text-white",children:w?"🎤 Listening...":O?"🔊 Speaking...":"Ask JohnnyCloud"}),i.jsx("span",{className:"text-xs text-slate-400",children:w?"Release to send":O?"Speaking response":"Hold to talk"})]}),!v.current&&i.jsxs("button",{onClick:()=>m(!h),className:"flex items-center gap-2 rounded-lg border border-slate-600/60 px-3 py-2 text-slate-200 hover:bg-slate-600/20","aria-label":"Toggle text input",children:[i.jsx(At,{className:"h-4 w-4"}),i.jsx("span",{className:"text-sm",children:"Text Input"})]})]}),c&&i.jsxs("div",{className:"p-3 bg-white/10 rounded-lg border border-white/20",children:[i.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"You said:"}),i.jsx("div",{className:"text-sm text-white",children:c})]}),h&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:y,onChange:f=>I(f.target.value),onKeyDown:f=>{f.key==="Enter"&&(f.preventDefault(),C()),f.key==="Escape"&&(m(!1),I(""))},placeholder:"Type your question here...",className:"flex-1 px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-sky-400",autoFocus:!0}),i.jsx("button",{onClick:C,disabled:!y.trim(),className:"px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-400 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"}),i.jsx("button",{onClick:()=>{m(!1),I("")},className:"px-3 py-2 border border-slate-600/60 text-slate-200 rounded-lg hover:bg-slate-600/20",children:"Cancel"})]}),i.jsx("div",{className:"text-xs text-slate-400",children:"Press Enter to send, Escape to cancel"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:D?g:d,disabled:!O&&!D,className:"flex items-center gap-1 rounded-lg border border-slate-600/60 px-2 py-1 text-slate-200 disabled:opacity-40 hover:bg-slate-600/20","aria-label":D?"Resume speech":"Pause speech",children:[i.jsx(Sn,{className:"h-3 w-3"}),i.jsx("span",{className:"text-xs",children:D?"Resume":"Pause"})]}),i.jsxs("button",{onClick:x,disabled:s==="idle",className:"flex items-center gap-1 rounded-lg border border-slate-600/60 px-2 py-1 text-slate-200 disabled:opacity-40 hover:bg-slate-600/20","aria-label":"Stop",children:[i.jsx(vn,{className:"h-3 w-3"}),i.jsx("span",{className:"text-xs",children:"Stop"})]}),i.jsxs("button",{onClick:()=>r&&j(r),disabled:!r,className:"flex items-center gap-1 rounded-lg border border-slate-600/60 px-2 py-1 text-slate-200 disabled:opacity-40 hover:bg-slate-600/20","aria-label":"Replay answer",children:[i.jsx(Tt,{className:"h-3 w-3"}),i.jsx("span",{className:"text-xs",children:"Replay"})]})]})]})}function Hn({currentPage:e,currentContext:t}){const{isOpen:n,closeChatbot:s,isActivated:o}=Ne(),{pageName:r,pageContext:a}=Gn(),[c,l]=u.useState([]),[h,m]=u.useState(!1),y=u.useRef(null),I=e||r,b=t||a;u.useEffect(()=>{var v;(v=y.current)==null||v.scrollIntoView({behavior:"smooth"})},[c]),u.useEffect(()=>{o&&n&&c.length===0&&l([{id:"welcome",type:"assistant",content:"Hello! I'm Johnny-5, your AWS cloud assistant. I heard you call my name! How can I help you today?",timestamp:new Date}])},[o,n,c.length]);const T=(v,j)=>{const d={id:`user-${Date.now()}`,type:"user",content:v,timestamp:new Date},g={id:`assistant-${Date.now()}`,type:"assistant",content:j,timestamp:new Date};l(x=>[...x,d,g])},K=()=>{l([])};return n?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),i.jsxs("div",{className:`relative bg-white/10 border border-white/20 rounded-2xl backdrop-blur-sm shadow-2xl transition-all duration-300 ${h?"w-80 h-16":"w-full max-w-2xl h-[600px]"}`,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white/10",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:i.jsx(At,{className:"w-4 h-4 text-white"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-white font-semibold",children:"Johnny-5 Assistant"}),i.jsxs("p",{className:"text-xs text-white/60",children:[o?"Activated by voice":"Global chatbot",I!=="global"&&` • ${I}`]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>m(!h),className:"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-colors",title:h?"Expand":"Minimize",children:h?"□":"—"}),i.jsx("button",{onClick:s,className:"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-colors",title:"Close",children:i.jsx(bn,{className:"w-4 h-4"})})]})]}),!h&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 h-[400px]",children:[c.map(v=>i.jsx("div",{className:`flex ${v.type==="user"?"justify-end":"justify-start"}`,children:i.jsxs("div",{className:`max-w-[80%] p-3 rounded-lg ${v.type==="user"?"bg-blue-500 text-white":"bg-white/10 text-white border border-white/20"}`,children:[i.jsx("p",{className:"text-sm","data-chat-msg":!0,children:v.content}),i.jsx("p",{className:"text-xs opacity-60 mt-1",children:v.timestamp.toLocaleTimeString()})]})},v.id)),i.jsx("div",{ref:y})]}),i.jsx("div",{className:"p-4 border-t border-white/10",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"flex-1",children:i.jsx(qn,{askEndpoint:"https://4z2t2pj4r4.execute-api.us-east-1.amazonaws.com/chat",context:{global:!0,...b},onSent:T})}),i.jsx("button",{onClick:K,className:"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-colors",title:"Clear messages",children:"🗑️"})]})}),i.jsx("div",{className:"p-3 border-t border-white/10 bg-white/5",children:i.jsx("p",{className:"text-xs text-white/50 text-center",children:'Say "Johnny 5" to activate • Press Ctrl+M to toggle hands-free mode'})})]})]})]}):null}function Jn(){const[e,t]=u.useState("idle"),{isOpen:n,toggleChatbot:s}=Ne();u.useEffect(()=>{const c=()=>{t("listening")},l=()=>{t("speaking")},h=()=>{t("idle")};return window.addEventListener("wakeWordDetected",c),window.addEventListener("chatbotActivated",l),window.addEventListener("chatbotClosed",h),t(n?"speaking":"idle"),()=>{window.removeEventListener("wakeWordDetected",c),window.removeEventListener("chatbotActivated",l),window.removeEventListener("chatbotClosed",h)}},[n]);const o=()=>{switch(e){case"idle":return"Idle";case"listening":return"Listening...";case"speaking":return"Speaking...";default:return"Idle"}},r=()=>{switch(e){case"idle":return"text-gray-400";case"listening":return"text-cyan-400";case"speaking":return"text-purple-400";default:return"text-gray-400"}},a=()=>{switch(e){case"idle":return"opacity-50";case"listening":return"johnny5-listening text-cyan-400";case"speaking":return"johnny5-speaking text-purple-400";default:return"opacity-50"}};return i.jsx("button",{onClick:s,className:`fixed top-4 right-4 z-50 p-3 rounded-full bg-black/20 backdrop-blur-sm border border-white/10 hover:bg-black/30 transition-all duration-300 ${a()}`,"aria-label":`Johnny 5 assistant - ${o()}`,title:`Johnny 5 Assistant - ${o()}. Click to toggle hands-free mode.`,children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:`w-8 h-8 ${r()} transition-colors duration-300`,children:i.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-full h-full",children:[i.jsx("rect",{x:"4",y:"6",width:"16",height:"12",rx:"2",fill:"currentColor",opacity:"0.8"}),i.jsx("circle",{cx:"8",cy:"10",r:"1.5",fill:"white"}),i.jsx("circle",{cx:"16",cy:"10",r:"1.5",fill:"white"}),i.jsx("circle",{cx:"8",cy:"10",r:"0.5",fill:"currentColor"}),i.jsx("circle",{cx:"16",cy:"10",r:"0.5",fill:"currentColor"}),i.jsx("rect",{x:"10",y:"14",width:"4",height:"1",rx:"0.5",fill:"white"}),i.jsx("line",{x1:"12",y1:"6",x2:"12",y2:"4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),i.jsx("circle",{cx:"12",cy:"3",r:"1",fill:"currentColor"})]})}),i.jsx("div",{className:`absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-black transition-colors duration-300 ${e==="idle"?"bg-gray-500":e==="listening"?"bg-cyan-400 animate-pulse":"bg-purple-400 animate-pulse"}`})]})})}const Xn=u.lazy(()=>H(()=>import("./Home-aa4e7f9c.js"),["assets/Home-aa4e7f9c.js","assets/react-vendor-cf6d7c8c.js","assets/Card-f7a2a7e8.js","assets/Button-d14573c5.js","assets/ui-vendor-5be21587.js","assets/dateUtils-ee9ad50a.js","assets/ErrorBoundary-84eedd88.js"])),Qn=u.lazy(()=>H(()=>import("./Metrics-6a9fbaac.js").then(e=>e.M),["assets/Metrics-6a9fbaac.js","assets/react-vendor-cf6d7c8c.js","assets/Heading-15e0f133.js","assets/Button-d14573c5.js","assets/ErrorBoundary-84eedd88.js"])),Yn=u.lazy(()=>H(()=>import("./Guardrails-2ed59a58.js"),["assets/Guardrails-2ed59a58.js","assets/react-vendor-cf6d7c8c.js","assets/Card-f7a2a7e8.js","assets/Button-d14573c5.js","assets/dateUtils-ee9ad50a.js","assets/chart-vendor-a9e21794.js","assets/ui-vendor-5be21587.js"])),Zn=u.lazy(()=>H(()=>import("./About-474d0727.js").then(e=>e.A),["assets/About-474d0727.js","assets/react-vendor-cf6d7c8c.js"])),es=u.lazy(()=>H(()=>import("./FAQ-6385152c.js"),["assets/FAQ-6385152c.js","assets/react-vendor-cf6d7c8c.js","assets/Card-f7a2a7e8.js","assets/Heading-15e0f133.js","assets/Button-d14573c5.js","assets/ui-vendor-5be21587.js"])),ts=u.lazy(()=>H(()=>import("./WhyAws-b615efbc.js"),["assets/WhyAws-b615efbc.js","assets/react-vendor-cf6d7c8c.js","assets/ui-vendor-5be21587.js"])),ns=u.lazy(()=>H(()=>import("./Login-35d643de.js"),["assets/Login-35d643de.js","assets/ui-vendor-5be21587.js","assets/react-vendor-cf6d7c8c.js"])),ss=u.lazy(()=>H(()=>import("./AuthCallback-1b2da159.js"),["assets/AuthCallback-1b2da159.js","assets/react-vendor-cf6d7c8c.js","assets/ui-vendor-5be21587.js"])),os=u.lazy(()=>H(()=>import("./SecurityWhitePaper-20ec93ce.js"),["assets/SecurityWhitePaper-20ec93ce.js","assets/ui-vendor-5be21587.js","assets/react-vendor-cf6d7c8c.js"]));function rs(){const{openChatbot:e}=Ne();return i.jsxs(i.Fragment,{children:[i.jsx(Fn,{onWakeWordDetected:()=>{console.log("🎯 Wake word detected - activating chatbot")},onChatbotActivated:()=>{console.log("🤖 Chatbot activated globally"),e()}}),i.jsx(Hn,{})]})}function is(){return i.jsx($n,{children:i.jsx("div",{className:"app-shell",children:i.jsxs(yn,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[i.jsxs(wn,{children:[i.jsxs(F,{element:i.jsx(Vn,{}),children:[i.jsx(F,{path:"/",element:i.jsx(u.Suspense,{fallback:i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:i.jsx(Xn,{})})}),i.jsx(F,{path:"/metrics",element:i.jsx(u.Suspense,{fallback:i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:i.jsx(Qn,{})})}),i.jsx(F,{path:"/guardrails",element:i.jsx(u.Suspense,{fallback:i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:i.jsx(Yn,{})})}),i.jsx(F,{path:"/why-aws",element:i.jsx(u.Suspense,{fallback:i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:i.jsx(ts,{})})}),i.jsx(F,{path:"/about",element:i.jsx(u.Suspense,{fallback:i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:i.jsx(Zn,{})})}),i.jsx(F,{path:"/faq",element:i.jsx(u.Suspense,{fallback:i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:i.jsx(es,{})})}),i.jsx(F,{path:"/security-whitepaper",element:i.jsx(u.Suspense,{fallback:i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:i.jsx(os,{})})})]}),i.jsx(F,{path:"/login",element:i.jsx(u.Suspense,{fallback:i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:i.jsx(ns,{})})}),i.jsx(F,{path:"/auth/callback",element:i.jsx(u.Suspense,{fallback:i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:i.jsx(ss,{})})})]}),i.jsx(rs,{}),i.jsx(Jn,{})]})})})}const as="Logging",cs="NoHubcallbackProvidedException";var V;(function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"})(V||(V={}));const Ze={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class ${constructor(t,n=V.WARN){this.name=t,this.level=n,this._pluggables=[]}_padding(t){return t<10?"0"+t:""+t}_ts(){const t=new Date;return[this._padding(t.getMinutes()),this._padding(t.getSeconds())].join(":")+"."+t.getMilliseconds()}configure(t){return t?(this._config=t,this._config):this._config}_log(t,...n){let s=this.level;$.LOG_LEVEL&&(s=$.LOG_LEVEL),typeof window<"u"&&window.LOG_LEVEL&&(s=window.LOG_LEVEL);const o=Ze[s];if(!(Ze[t]>=o))return;let a=console.log.bind(console);t===V.ERROR&&console.error&&(a=console.error.bind(console)),t===V.WARN&&console.warn&&(a=console.warn.bind(console)),$.BIND_ALL_LOG_LEVELS&&(t===V.INFO&&console.info&&(a=console.info.bind(console)),t===V.DEBUG&&console.debug&&(a=console.debug.bind(console)));const c=`[${t}] ${this._ts()} ${this.name}`;let l="";if(n.length===1&&typeof n[0]=="string")l=`${c} - ${n[0]}`,a(l);else if(n.length===1)l=`${c} ${n[0]}`,a(c,n[0]);else if(typeof n[0]=="string"){let h=n.slice(1);h.length===1&&(h=h[0]),l=`${c} - ${n[0]} ${h}`,a(`${c} - ${n[0]}`,h)}else l=`${c} ${n}`,a(c,n);for(const h of this._pluggables){const m={message:l,timestamp:Date.now()};h.pushLogs([m])}}log(...t){this._log(V.INFO,...t)}info(...t){this._log(V.INFO,...t)}warn(...t){this._log(V.WARN,...t)}error(...t){this._log(V.ERROR,...t)}debug(...t){this._log(V.DEBUG,...t)}verbose(...t){this._log(V.VERBOSE,...t)}addPluggable(t){t&&t.getCategoryName()===as&&(this._pluggables.push(t),t.configure(this._config))}listPluggables(){return this._pluggables}}$.LOG_LEVEL=null;$.BIND_ALL_LOG_LEVELS=!1;class B extends Error{constructor({message:t,name:n,recoverySuggestion:s,underlyingError:o,metadata:r}){if(super(t),this.name=n,this.underlyingError=o,this.recoverySuggestion=s,r){const{extendedRequestId:a,httpStatusCode:c,requestId:l}=r;this.metadata={extendedRequestId:a,httpStatusCode:c,requestId:l}}this.constructor=B,Object.setPrototypeOf(this,B.prototype)}}var Y;(function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"})(Y||(Y={}));const Ot=(e,t=B)=>(n,s,o)=>{const{message:r,recoverySuggestion:a}=e[s];if(!n)throw new t({name:s,message:o?`${r} ${o}`:r,recoverySuggestion:a})},me=typeof Symbol<"u"?Symbol("amplify_default"):"@@amplify_default",te=new $("Hub");class ds{constructor(t){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=t}_remove(t,n){const s=this.listeners.get(t);if(!s){te.warn(`No listeners for ${t}`);return}this.listeners.set(t,[...s.filter(({callback:o})=>o!==n)])}dispatch(t,n,s,o){typeof t=="string"&&this.protectedChannels.indexOf(t)>-1&&(o===me||te.warn(`WARNING: ${t} is protected and dispatching on it can have unintended consequences`));const r={channel:t,payload:{...n},source:s,patternInfo:[]};try{this._toListeners(r)}catch(a){te.error(a)}}listen(t,n,s="noname"){let o;if(typeof n!="function")throw new B({name:cs,message:"No callback supplied to Hub"});o=n;let r=this.listeners.get(t);return r||(r=[],this.listeners.set(t,r)),r.push({name:s,callback:o}),()=>{this._remove(t,o)}}_toListeners(t){const{channel:n,payload:s}=t,o=this.listeners.get(n);o&&o.forEach(r=>{te.debug(`Dispatching to ${n} with `,s);try{r.callback(t)}catch(a){te.error(a)}})}}const Te=new ds("__default__"),ls=()=>{if(typeof window<"u"&&typeof window.atob=="function")return window.atob;if(typeof atob=="function")return atob;throw new B({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})},us={convert(e,t){let n=e;return t!=null&&t.urlSafe&&(n=n.replace(/-/g,"+").replace(/_/g,"/")),ls()(n)}};var q;(function(e){e.AuthTokenConfigException="AuthTokenConfigException",e.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",e.AuthUserPoolException="AuthUserPoolException",e.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",e.OAuthNotConfigureException="OAuthNotConfigureException"})(q||(q={}));const hs={[q.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[q.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[q.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[q.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[q.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}},Dt=Ot(hs);function U(e){let t=!0;e?t=!!e.userPoolId&&!!e.userPoolClientId:t=!1,Dt(t,q.AuthUserPoolException)}function he(e){const t=!!(e!=null&&e.identityPoolId);Dt(t,q.InvalidIdentityPoolIdException)}function oe(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid token");try{const s=t[1].replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(us.convert(s).split("").map(a=>`%${`00${a.charCodeAt(0).toString(16)}`.slice(-2)}`).join("")),r=JSON.parse(o);return{toString:()=>e,payload:r}}catch{throw new Error("Invalid token payload")}}const Mt=e=>{const t=Reflect.ownKeys(e);for(const n of t){const s=e[n];(s&&typeof s=="object"||typeof s=="function")&&Mt(s)}return Object.freeze(e)},gs=new $("parseAWSExports"),fs={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},ms=(e={})=>{var We,Fe,Ge,ze,Be,qe;if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new B({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:n,aws_appsync_graphqlEndpoint:s,aws_appsync_region:o,aws_bots_config:r,aws_cognito_identity_pool_id:a,aws_cognito_sign_up_verification_method:c,aws_cognito_mfa_configuration:l,aws_cognito_mfa_types:h,aws_cognito_password_protection_settings:m,aws_cognito_verification_mechanisms:y,aws_cognito_signup_attributes:I,aws_cognito_social_providers:b,aws_cognito_username_attributes:T,aws_mandatory_sign_in:K,aws_mobile_analytics_app_id:v,aws_mobile_analytics_app_region:j,aws_user_files_s3_bucket:d,aws_user_files_s3_bucket_region:g,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:x,aws_user_pools_id:S,aws_user_pools_web_client_id:_,geo:M,oauth:C,predictions:w,aws_cloud_logic_custom:O,Notifications:D,modelIntrospection:f}=e,p={};v&&(p.Analytics={Pinpoint:{appId:v,region:j}});const{InAppMessaging:k,Push:P}=D??{};if(k!=null&&k.AWSPinpoint||P!=null&&P.AWSPinpoint){if(k!=null&&k.AWSPinpoint){const{appId:R,region:Q}=k.AWSPinpoint;p.Notifications={InAppMessaging:{Pinpoint:{appId:R,region:Q}}}}if(P!=null&&P.AWSPinpoint){const{appId:R,region:Q}=P.AWSPinpoint;p.Notifications={...p.Notifications,PushNotification:{Pinpoint:{appId:R,region:Q}}}}}if(Array.isArray(r)&&(p.Interactions={LexV1:Object.fromEntries(r.map(R=>[R.name,R]))}),s){const R=fs[n];R||gs.debug(`Invalid authentication type ${n}. Falling back to IAM.`),p.API={GraphQL:{endpoint:s,apiKey:t,region:o,defaultAuthMode:R??"iam"}},f&&(p.API.GraphQL.modelIntrospection=f)}const L=l?{status:l&&l.toLowerCase(),totpEnabled:(h==null?void 0:h.includes("TOTP"))??!1,smsEnabled:(h==null?void 0:h.includes("SMS"))??!1}:void 0,W=m?{minLength:m.passwordPolicyMinLength,requireLowercase:((We=m.passwordPolicyCharacters)==null?void 0:We.includes("REQUIRES_LOWERCASE"))??!1,requireUppercase:((Fe=m.passwordPolicyCharacters)==null?void 0:Fe.includes("REQUIRES_UPPERCASE"))??!1,requireNumbers:((Ge=m.passwordPolicyCharacters)==null?void 0:Ge.includes("REQUIRES_NUMBERS"))??!1,requireSpecialCharacters:((ze=m.passwordPolicyCharacters)==null?void 0:ze.includes("REQUIRES_SYMBOLS"))??!1}:void 0,dn=Array.from(new Set([...y??[],...I??[]])).reduce((R,Q)=>({...R,[Q.toLowerCase()]:{required:!0}}),{}),Ve=(T==null?void 0:T.includes("EMAIL"))??!1,$e=(T==null?void 0:T.includes("PHONE_NUMBER"))??!1;(a||S)&&(p.Auth={Cognito:{identityPoolId:a,allowGuestAccess:K!=="enable",signUpVerificationMethod:c,userAttributes:dn,userPoolClientId:_,userPoolId:S,mfa:L,passwordFormat:W,loginWith:{username:!(Ve||$e),email:Ve,phone:$e}}});const ln=C?Object.keys(C).length>0:!1,un=b?b.length>0:!1;if(p.Auth&&ln&&(p.Auth.Cognito.loginWith={...p.Auth.Cognito.loginWith,oauth:{...ps(C),...un&&{providers:ys(b)}}}),d&&(p.Storage={S3:{bucket:d,region:g,dangerouslyConnectToHttpEndpointForTesting:x}}),M){const{amazon_location_service:R}=M;p.Geo={LocationService:{maps:R.maps,geofenceCollections:R.geofenceCollections,searchIndices:R.search_indices,region:R.region}}}if(O&&(p.API={...p.API,REST:O.reduce((R,Q)=>{const{name:hn,endpoint:gn,region:He,service:Je}=Q;return{...R,[hn]:{endpoint:gn,...Je?{service:Je}:void 0,...He?{region:He}:void 0}}},{})}),w){const{VoiceId:R}=((qe=(Be=w==null?void 0:w.convert)==null?void 0:Be.speechGenerator)==null?void 0:qe.defaults)??{};p.Predictions=R?{...w,convert:{...w.convert,speechGenerator:{...w.convert.speechGenerator,defaults:{voiceId:R}}}}:w}return p},et=e=>(e==null?void 0:e.split(","))??[],ps=({domain:e,scope:t,redirectSignIn:n,redirectSignOut:s,responseType:o})=>({domain:e,scopes:t,redirectSignIn:et(n),redirectSignOut:et(s),responseType:o}),ys=e=>e.map(t=>{const n=t.toLowerCase();return n.charAt(0).toUpperCase()+n.slice(1)}),ws=Symbol("oauth-listener"),N=[];for(let e=0;e<256;++e)N.push((e+256).toString(16).slice(1));function Is(e,t=0){return(N[e[t+0]]+N[e[t+1]]+N[e[t+2]]+N[e[t+3]]+"-"+N[e[t+4]]+N[e[t+5]]+"-"+N[e[t+6]]+N[e[t+7]]+"-"+N[e[t+8]]+N[e[t+9]]+"-"+N[e[t+10]]+N[e[t+11]]+N[e[t+12]]+N[e[t+13]]+N[e[t+14]]+N[e[t+15]]).toLowerCase()}let Ee;const xs=new Uint8Array(16);function Ss(){if(!Ee){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ee=crypto.getRandomValues.bind(crypto)}return Ee(xs)}const vs=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),tt={randomUUID:vs};function bs(e,t,n){var o;if(tt.randomUUID&&!t&&!e)return tt.randomUUID();e=e||{};const s=e.random??((o=e.rng)==null?void 0:o.call(e))??Ss();if(s.length<16)throw new Error("Random bytes length must be >= 16");if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,t){if(n=n||0,n<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let r=0;r<16;++r)t[n+r]=s[r];return t}return Is(s)}function Cs(e){const{version:t}=e;return t?t.startsWith("1"):!1}function Es(e){if(!e)return;const{bucket_name:t,aws_region:n,buckets:s}=e;return{S3:{bucket:t,region:n,buckets:s&&Ms(s)}}}function _s(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:n,identity_pool_id:s,password_policy:o,mfa_configuration:r,mfa_methods:a,unauthenticated_identities_enabled:c,oauth:l,username_attributes:h,standard_required_attributes:m,groups:y}=e,I={Cognito:{userPoolId:t,userPoolClientId:n,groups:y}};return s&&(I.Cognito={...I.Cognito,identityPoolId:s}),o&&(I.Cognito.passwordFormat={requireLowercase:o.require_lowercase,requireNumbers:o.require_numbers,requireUppercase:o.require_uppercase,requireSpecialCharacters:o.require_symbols,minLength:o.min_length??6}),r&&(I.Cognito.mfa={status:Ds(r),smsEnabled:a==null?void 0:a.includes("SMS"),totpEnabled:a==null?void 0:a.includes("TOTP")}),c&&(I.Cognito.allowGuestAccess=c),l&&(I.Cognito.loginWith={oauth:{domain:l.domain,redirectSignIn:l.redirect_sign_in_uri,redirectSignOut:l.redirect_sign_out_uri,responseType:l.response_type==="token"?"token":"code",scopes:l.scopes,providers:Os(l.identity_providers)}}),h&&(I.Cognito.loginWith={...I.Cognito.loginWith,email:h.includes("email"),phone:h.includes("phone_number"),username:h.includes("username")}),m&&(I.Cognito.userAttributes=m.reduce((b,T)=>({...b,[T]:{required:!0}}),{})),I}function ks(e){if(!(e!=null&&e.amazon_pinpoint))return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}function Ts(e){if(!e)return;const{aws_region:t,geofence_collections:n,maps:s,search_indices:o}=e;return{LocationService:{region:t,searchIndices:o,geofenceCollections:n,maps:s}}}function As(e){if(!e)return;const{aws_region:t,default_authorization_type:n,url:s,api_key:o,model_introspection:r}=e;return{GraphQL:{endpoint:s,defaultAuthMode:Lt(n),region:t,apiKey:o,modelIntrospection:r}}}function Rs(e){if(!(e!=null&&e.events))return;const{url:t,aws_region:n,api_key:s,default_authorization_type:o}=e.events;return{Events:{endpoint:t,defaultAuthMode:Lt(o),region:n,apiKey:s}}}function Ps(e){if(!e)return;const{aws_region:t,channels:n,amazon_pinpoint_app_id:s}=e,o=n.includes("IN_APP_MESSAGING"),r=n.includes("APNS")||n.includes("FCM");if(!(o||r))return;const a={};return o&&(a.InAppMessaging={Pinpoint:{appId:s,region:t}}),r&&(a.PushNotification={Pinpoint:{appId:s,region:t}}),a}function Ns(e){const t={};if(e.storage&&(t.Storage=Es(e.storage)),e.auth&&(t.Auth=_s(e.auth)),e.analytics&&(t.Analytics=ks(e.analytics)),e.geo&&(t.Geo=Ts(e.geo)),e.data&&(t.API=As(e.data)),e.custom){const n=Rs(e.custom);n&&"Events"in n&&(t.API={...t.API,...n})}return e.notifications&&(t.Notifications=Ps(e.notifications)),t}const js={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function Lt(e){return js[e]}const nt={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function Os(e=[]){return e.reduce((t,n)=>(nt[n]!==void 0&&t.push(nt[n]),t),[])}function Ds(e){return e==="OPTIONAL"?"optional":e==="REQUIRED"?"on":"off"}function Ms(e){const t={};return e.forEach(({name:n,bucket_name:s,aws_region:o,paths:r})=>{if(n in t)throw new Error(`Duplicate friendly name found: ${n}. Name must be unique.`);const a=r?Object.entries(r).reduce((c,[l,h])=>(h!==void 0&&(c[l]=h),c),{}):void 0;t[n]={bucketName:s,region:o,paths:a}}),t}const Ut=e=>Object.keys(e).some(t=>t.startsWith("aws_"))?ms(e):Cs(e)?Ns(e):e,Ls=e=>new TextEncoder().encode(e);typeof Buffer<"u"&&Buffer.from;for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`)}var A;(function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"})(A||(A={}));var st;(function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"})(st||(st={}));var ot;(function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"})(ot||(ot={}));var rt;(function(e){e.Record="1",e.IdentifyUser="2"})(rt||(rt={}));var it;(function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"})(it||(it={}));var at;(function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"})(at||(at={}));var ct;(function(e){e.Subscribe="1",e.GraphQl="2"})(ct||(ct={}));var dt;(function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"})(dt||(dt={}));var lt;(function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"})(lt||(lt={}));var ut;(function(e){e.None="0"})(ut||(ut={}));var ht;(function(e){e.Convert="1",e.Identify="2",e.Interpret="3"})(ht||(ht={}));var gt;(function(e){e.Subscribe="1"})(gt||(gt={}));var ft;(function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"})(ft||(ft={}));var mt;(function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"})(mt||(mt={}));const Kt="6.15.6",Ie=()=>typeof global<"u",ee=()=>typeof window<"u",Vt=()=>typeof document<"u",je=()=>typeof process<"u",re=(e,t)=>!!Object.keys(e).find(n=>n.startsWith(t));function Us(){const e=s=>s.startsWith("_react")||s.startsWith("__react"),t=s=>Object.keys(s).find(e),n=()=>Array.from(document.querySelectorAll("[id]"));return Vt()&&n().some(t)}function Ks(){return je()&&typeof process.env<"u"&&!!Object.keys(process.env).find(e=>e.includes("react"))}function Vs(){return ee()&&re(window,"__VUE")}function $s(){return Ie()&&re(global,"__VUE")}function Ws(){return ee()&&re(window,"__SVELTE")}function Fs(){return je()&&typeof process.env<"u"&&!!Object.keys(process.env).find(e=>e.includes("svelte"))}function Gs(){return ee()&&window.next&&typeof window.next=="object"}function zs(){return Ie()&&(re(global,"__next")||re(global,"__NEXT"))}function Bs(){return ee()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function qs(){return Ie()&&typeof global.__NUXT_PATHS__<"u"}function Hs(){const e=!!(Vt()&&document.querySelector("[ng-version]")),t=!!(ee()&&typeof window.ng<"u");return e||t}function Js(){var e;return je()&&typeof process.env=="object"&&((e={}.npm_lifecycle_script)==null?void 0:e.startsWith("ng "))||!1}function Xs(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function Qs(){return Ie()&&typeof global.expo<"u"}function Ys(){return ee()}const Zs=[{platform:A.Expo,detectionMethod:Qs},{platform:A.ReactNative,detectionMethod:Xs},{platform:A.NextJs,detectionMethod:Gs},{platform:A.Nuxt,detectionMethod:Bs},{platform:A.Angular,detectionMethod:Hs},{platform:A.React,detectionMethod:Us},{platform:A.VueJs,detectionMethod:Vs},{platform:A.Svelte,detectionMethod:Ws},{platform:A.WebUnknown,detectionMethod:Ys},{platform:A.NextJsSSR,detectionMethod:zs},{platform:A.NuxtSSR,detectionMethod:qs},{platform:A.ReactSSR,detectionMethod:Ks},{platform:A.VueJsSSR,detectionMethod:$s},{platform:A.AngularSSR,detectionMethod:Js},{platform:A.SvelteSSR,detectionMethod:Fs}];function eo(){var e;return((e=Zs.find(t=>t.detectionMethod()))==null?void 0:e.platform)||A.ServerSideUnknown}let se;const ge=[];let pe=!1;const to=10,no=10,so=1e3,Oe=()=>{var e;if(!se){if(se=eo(),pe)for(;ge.length;)(e=ge.pop())==null||e();else ge.forEach(t=>{t()});pt(A.ServerSideUnknown,to),pt(A.WebUnknown,no)}return se},oo=e=>{pe||ge.push(e)};function ro(){se=void 0}function pt(e,t){se===e&&!pe&&setTimeout(()=>{ro(),pe=!0,setTimeout(Oe,so)},t)}const io={},ao=(e,t)=>{var n,s;return(s=(n=io[e])==null?void 0:n[t])==null?void 0:s.additionalDetails},$t="aws-amplify",Wt=e=>e.replace(/\+.*/,"");class co{constructor(){this.userAgent=`${$t}/${Wt(Kt)}`}get framework(){return Oe()}get isReactNative(){return this.framework===A.ReactNative||this.framework===A.Expo}observeFrameworkChanges(t){oo(t)}}new co;const lo=({category:e,action:t}={})=>{const n=[[$t,Wt(Kt)]];if(e&&n.push([e,t]),n.push(["framework",Oe()]),e&&t){const s=ao(e,t);s&&s.forEach(o=>{n.push(o)})}return n},De=e=>lo(e).map(([s,o])=>s&&o?`${s}/${o}`:s).join(" "),uo=()=>typeof window<"u"&&typeof window.document<"u",yt=new $("Auth");class ho{configure(t,n){var s,o;this.authConfig=t,this.authOptions=n,t&&((s=t.Cognito)!=null&&s.userPoolEndpoint)&&yt.warn(wt("Amazon Cognito User Pool")),t&&((o=t.Cognito)!=null&&o.identityPoolEndpoint)&&yt.warn(wt("Amazon Cognito Identity Pool"))}async fetchAuthSession(t={}){var r,a,c,l,h,m;let n,s;const o=await this.getTokens(t);return o?(s=(a=(r=o.accessToken)==null?void 0:r.payload)==null?void 0:a.sub,n=await((l=(c=this.authOptions)==null?void 0:c.credentialsProvider)==null?void 0:l.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:o,authenticated:!0,forceRefresh:t.forceRefresh}))):n=await((m=(h=this.authOptions)==null?void 0:h.credentialsProvider)==null?void 0:m.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:t.forceRefresh})),{tokens:o,credentials:n==null?void 0:n.credentials,identityId:n==null?void 0:n.identityId,userSub:s}}async clearCredentials(){var t,n;await((n=(t=this.authOptions)==null?void 0:t.credentialsProvider)==null?void 0:n.clearCredentialsAndIdentityId())}async getTokens(t){var n,s;return await((s=(n=this.authOptions)==null?void 0:n.tokenProvider)==null?void 0:s.getTokens(t))??void 0}}const wt=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;class go{constructor(){this.oAuthListener=void 0,this.isConfigured=!1,this.resourcesConfig={},this.libraryOptions={},this.Auth=new ho}configure(t,n){const s=Ut(t);this.resourcesConfig=s,n&&(this.libraryOptions=n),this.resourcesConfig=Mt(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),Te.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",me),this.notifyOAuthListener(),this.isConfigured=!0}getConfig(){return this.isConfigured||console.warn("Amplify has not been configured. Please call Amplify.configure() before using this service."),this.resourcesConfig}[ws](t){var n,s,o;(s=(n=this.resourcesConfig.Auth)==null?void 0:n.Cognito.loginWith)!=null&&s.oauth?t((o=this.resourcesConfig.Auth)==null?void 0:o.Cognito):this.oAuthListener=t}notifyOAuthListener(){var t,n,s;!((n=(t=this.resourcesConfig.Auth)==null?void 0:t.Cognito.loginWith)!=null&&n.oauth)||!this.oAuthListener||(this.oAuthListener((s=this.resourcesConfig.Auth)==null?void 0:s.Cognito),this.oAuthListener=void 0)}}const X=new go,xe=e=>{const{headers:t,statusCode:n}=e;return{...fo(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},fo=e=>typeof(e==null?void 0:e.$metadata)=="object",ae=async e=>{if(!e||e.statusCode<300)return;const t=await Se(e),s=(a=>{const[c]=a.toString().split(/[,:]+/);return c.includes("#")?c.split("#")[1]:c})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),o=t.message??t.Message??"Unknown error",r=new Error(o);return Object.assign(r,{name:s,$metadata:xe(e)})},Se=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:xe(e)})},Me=(e,t,n,s)=>async(o,r)=>{const a={...s,...o},c=await a.endpointResolver(a,r),l=await t(r,c),h=await e(l,{...a});return n(h)},mo=5*60*1e3;function po(e=mo){return s=>{const o=2**s*100+100*Math.random();return o>e?!1:o}}const Ft=3,It="amz-sdk-invocation-id",yo="amz-sdk-request",xt=5*60*1e3,Gt=e=>{const n=po(xt)(e);return n===!1?xt:n},wo=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],Io=e=>!!e&&wo.includes(e),zt=e=>async(t,n)=>{const s=n??await e(t)??void 0,o=(s==null?void 0:s.code)||(s==null?void 0:s.name),r=t==null?void 0:t.statusCode;return{retryable:bo(n)||vo(r,o)||Io(o)||Co(r,o)}},xo=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],So=["TimeoutError","RequestTimeout","RequestTimeoutException"],vo=(e,t)=>e===429||!!t&&xo.includes(t),bo=e=>[Y.NetworkError,"ERR_NETWORK"].includes(e==null?void 0:e.name),Co=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&So.includes(t),Bt="cognito-identity",qt={service:Bt,retryDecider:zt(ae),computeDelay:Gt,cache:"no-store"},Eo=({maxAttempts:e=Ft,retryDecider:t,computeDelay:n,abortSignal:s})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(o,r)=>async function(c){let l,h=r.attemptsCount??0,m;const y=()=>{if(m)return St(m,h),m;throw St(l,h),l};for(;!(s!=null&&s.aborted)&&h<e;){try{m=await o(c),l=void 0}catch(T){l=T,m=void 0}h=(r.attemptsCount??0)>h?r.attemptsCount??0:h+1,r.attemptsCount=h;const{isCredentialsExpiredError:I,retryable:b}=await t(m,l,r);if(b){if(r.isCredentialsExpired=!!I,!(s!=null&&s.aborted)&&h<e){const T=n(h);await _o(T,s)}continue}else return y()}if(s!=null&&s.aborted)throw new Error("Request aborted.");return y()}},_o=(e,t)=>{if(t!=null&&t.aborted)return Promise.resolve();let n,s;const o=new Promise(r=>{s=r,n=setTimeout(r,e)});return t==null||t.addEventListener("abort",function r(a){clearTimeout(n),t==null||t.removeEventListener("abort",r),s()}),o},St=(e,t)=>{Object.prototype.toString.call(e)==="[object Object]"&&(e.$metadata={...e.$metadata??{},attempts:t})},ko=bs,To=()=>e=>async function(n){return n.headers[It]||(n.headers[It]=ko()),e(n)},Ao=({maxAttempts:e=Ft})=>(t,n)=>async function(o){const r=n.attemptsCount??0;return o.headers[yo]=`attempt=${r+1}; max=${e}`,t(o)},Ro=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(o){if(t.trim().length===0)return await n(o);{const r=e.toLowerCase();return o.headers[r]=o.headers[r]?`${o.headers[r]} ${t}`:t,await n(o)}},Le=(e,t)=>(n,s)=>{const o={};let r=a=>e(a,s);for(let a=t.length-1;a>=0;a--){const c=t[a];r=c(s)(r,o)}return r(n)},_e=e=>{let t;return()=>(t||(t=e()),t)},Po=e=>!["HEAD","GET"].includes(e.toUpperCase()),No=async({url:e,method:t,headers:n,body:s},{abortSignal:o,cache:r,withCrossDomainCredentials:a})=>{var y;let c;try{c=await fetch(e,{method:t,headers:n,body:Po(t)?s:void 0,signal:o,cache:r,credentials:a?"include":"same-origin"})}catch(I){throw I instanceof TypeError?new B({name:Y.NetworkError,message:"A network error has occurred.",underlyingError:I}):I}const l={};(y=c.headers)==null||y.forEach((I,b)=>{l[b.toLowerCase()]=I});const h={statusCode:c.status,headers:l,body:null},m=Object.assign(c.body??{},{text:_e(()=>c.text()),blob:_e(()=>c.blob()),json:_e(()=>c.json())});return{...h,body:m}},Ht=Le(No,[Ro,To,Eo,Ao]),jo=()=>e=>async function(n){return n.headers["cache-control"]="no-store",e(n)},Jt=Le(Ht,[jo]),Xt=e=>(t,n)=>{const s=Oo(e),o=JSON.stringify(t);return Do(n,s,o)},Oo=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),Do=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),vt=e=>Me(Jt,Xt("GetCredentialsForIdentity"),Mo,{...qt,...e,userAgentValue:De()}),Mo=async e=>{if(e.statusCode>=300)throw await ae(e);const t=await Se(e);return{IdentityId:t.IdentityId,Credentials:Lo(t.Credentials),$metadata:xe(e)}},Lo=({Expiration:e,...t}={})=>({...t,Expiration:e&&new Date(e*1e3)}),Uo=e=>Me(Jt,Xt("GetId"),Ko,{...qt,...e,userAgentValue:De()}),Ko=async e=>{if(e.statusCode>=300)throw await ae(e);return{IdentityId:(await Se(e)).IdentityId,$metadata:xe(e)}},Qt={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},Vo={partitions:[Qt,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},Yt=e=>{const{partitions:t}=Vo;for(const{regions:n,outputs:s,regionRegex:o}of t){const r=new RegExp(o);if(n.includes(e)||r.test(e))return s.dnsSuffix}return Qt.outputs.dnsSuffix},ve=URL,$o=({region:e})=>({url:new ve(`https://${Bt}.${e}.${Yt(e)}`)});class ne extends B{constructor(){super({name:Y.PlatformNotSupported,message:"Function not supported on current platform"})}}class Zt{constructor(t){this.storage=t}async setItem(t,n){if(!this.storage)throw new ne;this.storage.setItem(t,n)}async getItem(t){if(!this.storage)throw new ne;return this.storage.getItem(t)}async removeItem(t){if(!this.storage)throw new ne;this.storage.removeItem(t)}async clear(){if(!this.storage)throw new ne;this.storage.clear()}}class en{constructor(){this.storage=new Map}get length(){return this.storage.size}key(t){return t>this.length-1?null:Array.from(this.storage.keys())[t]}setItem(t,n){this.storage.set(t,n)}getItem(t){return this.storage.get(t)??null}removeItem(t){this.storage.delete(t)}clear(){this.storage.clear()}}const tn=new $("CoreStorageUtils"),Wo=()=>{try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{tn.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new en},nn=()=>{try{if(typeof window<"u"&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch{return tn.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new en}};class Fo extends Zt{constructor(){super(Wo())}}class Go extends Zt{constructor(){super(nn())}}class zo{constructor(t){this._storage=t}get storage(){if(!this._storage)throw new ne;return this._storage}setItem(t,n){this.storage.setItem(t,n)}getItem(t){return this.storage.getItem(t)}removeItem(t){this.storage.removeItem(t)}clear(){this.storage.clear()}}class Bo extends zo{constructor(){super(nn())}}/*! js-cookie v3.0.5 | MIT */function ce(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)e[s]=n[s]}return e}var qo={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Ae(e,t){function n(o,r,a){if(!(typeof document>"u")){a=ce({},t,a),typeof a.expires=="number"&&(a.expires=new Date(Date.now()+a.expires*864e5)),a.expires&&(a.expires=a.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var l in a)a[l]&&(c+="; "+l,a[l]!==!0&&(c+="="+a[l].split(";")[0]));return document.cookie=o+"="+e.write(r,o)+c}}function s(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var r=document.cookie?document.cookie.split("; "):[],a={},c=0;c<r.length;c++){var l=r[c].split("="),h=l.slice(1).join("=");try{var m=decodeURIComponent(l[0]);if(a[m]=e.read(h,m),o===m)break}catch{}}return o?a[o]:a}}return Object.create({set:n,get:s,remove:function(o,r){n(o,"",ce({},r,{expires:-1}))},withAttributes:function(o){return Ae(this.converter,ce({},this.attributes,o))},withConverter:function(o){return Ae(ce({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var de=Ae(qo,{path:"/"});class Ho{constructor(t={}){const{path:n,domain:s,expires:o,sameSite:r,secure:a}=t;if(this.domain=s,this.path=n||"/",this.expires=Object.prototype.hasOwnProperty.call(t,"expires")?o:365,this.secure=Object.prototype.hasOwnProperty.call(t,"secure")?a:!0,Object.prototype.hasOwnProperty.call(t,"sameSite")){if(!r||!["strict","lax","none"].includes(r))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if(r==="none"&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=r}}async setItem(t,n){de.set(t,n,this.getData())}async getItem(t){return de.get(t)??null}async removeItem(t){de.remove(t,this.getData())}async clear(){const t=de.get(),n=Object.keys(t).map(s=>this.removeItem(s));await Promise.all(n)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const be=new Fo;new Go;new Bo;const Jo=e=>{let t;return async(...n)=>t||(t=new Promise((s,o)=>{e(...n).then(r=>{s(r)}).catch(r=>{o(r)}).finally(()=>{t=void 0})}),t)};function bt({expiresAt:e,clockDrift:t,tolerance:n=5e3}){return Date.now()+t+n>e}class E extends B{constructor(t){super(t),this.constructor=E,Object.setPrototypeOf(this,E.prototype)}}function Xo(e){const t=e==null?void 0:e.split("_")[0];if(!e||e.indexOf("_")<0||!t||typeof t!="string")throw new E({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function Re(e){if(!e||!e.includes(":"))throw new E({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}const Ue="UserUnAuthenticatedException",Qo="InvalidRedirectException",Yo="InvalidAppSchemeException",Zo="InvalidPreferredRedirectUrlException";new E({name:Qo,message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."});new E({name:Yo,message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."});new E({name:Zo,message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."});const er="InvalidOriginException";new E({name:er,message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."});const tr="TokenRefreshException";function Wr(e){if(!e||!e.accessToken)throw new E({name:Ue,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}function nr(e){if(!e||!e.idToken)throw new E({name:Ue,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const sr=new E({name:tr,message:`Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. 
	Please change your oauth configuration to use 'code grant' flow.`,recoverySuggestion:`Please logout and change your Amplify configuration to use "code grant" flow. 
	E.g { responseType: 'code' }`}),or=new E({name:Ue,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function rr(e){if(cr(e))throw sr;if(!ar(e))throw or}const ir={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function sn(e){return(e==null?void 0:e.accessToken)||(e==null?void 0:e.idToken)}function ar(e){return sn(e)&&(e==null?void 0:e.refreshToken)}function cr(e){return sn(e)&&!(e!=null&&e.refreshToken)}const dr=e=>(t,n)=>{const s=lr(e),o=JSON.stringify(t);return ur(n,s,o)},lr=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),ur=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"});function ie(e){if(!e||e.name==="Error"||e instanceof TypeError)throw new E({name:Y.Unknown,message:"An unknown error has occurred.",underlyingError:e})}const hr=()=>async e=>{if(e.statusCode>=300){const t=await ae(e);throw ie(t),new E({name:t.name,message:t.message,metadata:t.$metadata})}return Se(e)},gr=()=>(e,t)=>async function(s){return s.headers["cache-control"]="no-store",e(s)},fr=Le(Ht,[gr]),on="cognito-idp",mr={service:on,retryDecider:zt(ae),computeDelay:Gt,get userAgentValue(){return De()},cache:"no-store"},pr=({region:e})=>({url:new ve(`https://${on}.${e}.${Yt(e)}`)}),yr=({endpointOverride:e})=>t=>e?{url:new ve(e)}:pr(t),wr=e=>Me(fr,dr("GetTokensFromRefreshToken"),hr(),{...mr,...e}),Ir=async({tokens:e,authConfig:t,username:n})=>{var b;U(t==null?void 0:t.Cognito);const{userPoolId:s,userPoolClientId:o,userPoolEndpoint:r}=t.Cognito,a=Xo(s);rr(e);const c=wr({endpointResolver:yr({endpointOverride:r})}),{AuthenticationResult:l}=await c({region:a},{ClientId:o,RefreshToken:e.refreshToken,DeviceKey:(b=e.deviceMetadata)==null?void 0:b.deviceKey}),h=oe((l==null?void 0:l.AccessToken)??""),m=l!=null&&l.IdToken?oe(l.IdToken):void 0,{iat:y}=h.payload;if(!y)throw new E({name:"iatNotFoundException",message:"iat not found in access token"});const I=y*1e3-new Date().getTime();return{accessToken:h,idToken:m,clockDrift:I,refreshToken:(l==null?void 0:l.RefreshToken)??e.refreshToken,username:n}},xr=Jo(Ir),Sr={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var ye;(function(e){e.InvalidAuthTokens="InvalidAuthTokens"})(ye||(ye={}));const vr={[ye.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}},br=Ot(vr),Ct="CognitoIdentityServiceProvider";class Cr{getKeyValueStorage(){if(!this.keyValueStorage)throw new E({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(t){this.keyValueStorage=t}setAuthConfig(t){this.authConfig=t}async loadTokens(){try{const t=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t.accessToken);if(!n)throw new E({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const s=oe(n),o=await this.getKeyValueStorage().getItem(t.idToken),r=o?oe(o):void 0,a=await this.getKeyValueStorage().getItem(t.refreshToken)??void 0,c=await this.getKeyValueStorage().getItem(t.clockDrift)??"0",l=Number.parseInt(c),h=await this.getKeyValueStorage().getItem(t.signInDetails),m={accessToken:s,idToken:r,refreshToken:a,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:l,username:await this.getLastAuthUser()};return h&&(m.signInDetails=JSON.parse(h)),m}catch{return null}}async storeTokens(t){br(t!==void 0,ye.InvalidAuthTokens);const n=t.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),n);const s=await this.getAuthKeys();await this.getKeyValueStorage().setItem(s.accessToken,t.accessToken.toString()),t.idToken?await this.getKeyValueStorage().setItem(s.idToken,t.idToken.toString()):await this.getKeyValueStorage().removeItem(s.idToken),t.refreshToken?await this.getKeyValueStorage().setItem(s.refreshToken,t.refreshToken):await this.getKeyValueStorage().removeItem(s.refreshToken),t.deviceMetadata&&(t.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(s.deviceKey,t.deviceMetadata.deviceKey),t.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(s.deviceGroupKey,t.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(s.randomPasswordKey,t.deviceMetadata.randomPassword)),t.signInDetails?await this.getKeyValueStorage().setItem(s.signInDetails,JSON.stringify(t.signInDetails)):await this.getKeyValueStorage().removeItem(s.signInDetails),await this.getKeyValueStorage().setItem(s.clockDrift,`${t.clockDrift}`)}async clearTokens(){const t=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(t.accessToken),this.getKeyValueStorage().removeItem(t.idToken),this.getKeyValueStorage().removeItem(t.clockDrift),this.getKeyValueStorage().removeItem(t.refreshToken),this.getKeyValueStorage().removeItem(t.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(t.oauthMetadata)])}async getDeviceMetadata(t){const n=await this.getAuthKeys(t),s=await this.getKeyValueStorage().getItem(n.deviceKey),o=await this.getKeyValueStorage().getItem(n.deviceGroupKey),r=await this.getKeyValueStorage().getItem(n.randomPasswordKey);return r&&o&&s?{deviceKey:s,deviceGroupKey:o,randomPassword:r}:null}async clearDeviceMetadata(t){const n=await this.getAuthKeys(t);await Promise.all([this.getKeyValueStorage().removeItem(n.deviceKey),this.getKeyValueStorage().removeItem(n.deviceGroupKey),this.getKeyValueStorage().removeItem(n.randomPasswordKey)])}async getAuthKeys(t){var s;U((s=this.authConfig)==null?void 0:s.Cognito);const n=t??await this.getLastAuthUser();return Er(Ct,`${this.authConfig.Cognito.userPoolClientId}.${n}`)}getLastAuthUserKey(){var n;U((n=this.authConfig)==null?void 0:n.Cognito);const t=this.authConfig.Cognito.userPoolClientId;return`${Ct}.${t}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(t){const{oauthMetadata:n}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n,JSON.stringify(t))}async getOAuthMetadata(){const{oauthMetadata:t}=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t);return n&&JSON.parse(n)}}const Er=(e,t)=>Ke(Sr)(`${e}`,t);function Ke(e){const t=Object.values({...e});return(n,s)=>t.reduce((o,r)=>({...o,[r]:`${n}.${s}.${r}`}),{})}const Et="amplify-signin-with-hostedUI",G="CognitoIdentityServiceProvider";class _r{constructor(t){this.keyValueStorage=t}async clearOAuthInflightData(){U(this.cognitoConfig);const t=z(G,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(t.inflightOAuth),this.keyValueStorage.removeItem(t.oauthPKCE),this.keyValueStorage.removeItem(t.oauthState)])}async clearOAuthData(){U(this.cognitoConfig);const t=z(G,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(Et),this.keyValueStorage.removeItem(t.oauthSignIn)}loadOAuthState(){U(this.cognitoConfig);const t=z(G,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthState)}storeOAuthState(t){U(this.cognitoConfig);const n=z(G,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthState,t)}loadPKCE(){U(this.cognitoConfig);const t=z(G,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthPKCE)}storePKCE(t){U(this.cognitoConfig);const n=z(G,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthPKCE,t)}setAuthConfig(t){this.cognitoConfig=t}async loadOAuthInFlight(){U(this.cognitoConfig);const t=z(G,this.cognitoConfig.userPoolClientId);return await this.keyValueStorage.getItem(t.inflightOAuth)==="true"}async storeOAuthInFlight(t){U(this.cognitoConfig);const n=z(G,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.inflightOAuth,`${t}`)}async loadOAuthSignIn(){var r;U(this.cognitoConfig);const t=z(G,this.cognitoConfig.userPoolClientId),n=await this.keyValueStorage.getItem(Et),[s,o]=((r=await this.keyValueStorage.getItem(t.oauthSignIn))==null?void 0:r.split(","))??[];return{isOAuthSignIn:s==="true"||n==="true",preferPrivateSession:o==="true"}}async storeOAuthSignIn(t,n=!1){U(this.cognitoConfig);const s=z(G,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(s.oauthSignIn,`${t},${n}`)}}const z=(e,t)=>Ke(ir)(e,t),_t=new _r(be),kr=[],Tr=e=>{kr.push(e)};class Ar{constructor(){this.waitForInflightOAuth=uo()?async()=>{if(await _t.loadOAuthInFlight())return this.inflightPromise?this.inflightPromise:(this.inflightPromise=new Promise((t,n)=>{Tr(t)}),this.inflightPromise)}:async()=>{}}setAuthConfig(t){_t.setAuthConfig(t.Cognito),this.authConfig=t}setTokenRefresher(t){this.tokenRefresher=t}setAuthTokenStore(t){this.tokenStore=t}getTokenStore(){if(!this.tokenStore)throw new E({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new E({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(t){var a,c,l,h,m;let n;try{U((a=this.authConfig)==null?void 0:a.Cognito)}catch{return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,n=await this.getTokenStore().loadTokens();const s=await this.getTokenStore().getLastAuthUser();if(n===null)return null;const o=!!(n!=null&&n.idToken)&&bt({expiresAt:(((l=(c=n.idToken)==null?void 0:c.payload)==null?void 0:l.exp)??0)*1e3,clockDrift:n.clockDrift??0}),r=bt({expiresAt:(((m=(h=n.accessToken)==null?void 0:h.payload)==null?void 0:m.exp)??0)*1e3,clockDrift:n.clockDrift??0});return(t!=null&&t.forceRefresh||o||r)&&(n=await this.refreshTokens({tokens:n,username:s}),n===null)?null:{accessToken:n==null?void 0:n.accessToken,idToken:n==null?void 0:n.idToken,signInDetails:n==null?void 0:n.signInDetails}}async refreshTokens({tokens:t,username:n}){try{const{signInDetails:s}=t,o=await this.getTokenRefresher()({tokens:t,authConfig:this.authConfig,username:n});return o.signInDetails=s,await this.setTokens({tokens:o}),Te.dispatch("auth",{event:"tokenRefresh"},"Auth",me),o}catch(s){return this.handleErrors(s)}}handleErrors(t){if(ie(t),t.name!==Y.NetworkError&&this.clearTokens(),Te.dispatch("auth",{event:"tokenRefresh_failure",data:{error:t}},"Auth",me),t.name.startsWith("NotAuthorizedException"))return null;throw t}async setTokens({tokens:t}){return this.getTokenStore().storeTokens(t)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(t){return this.getTokenStore().getDeviceMetadata(t)}clearDeviceMetadata(t){return this.getTokenStore().clearDeviceMetadata(t)}setOAuthMetadata(t){return this.getTokenStore().setOAuthMetadata(t)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}class Rr{constructor(){this.authTokenStore=new Cr,this.authTokenStore.setKeyValueStorage(be),this.tokenOrchestrator=new Ar,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(xr)}getTokens({forceRefresh:t}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:t})}setKeyValueStorage(t){this.authTokenStore.setKeyValueStorage(t)}setAuthConfig(t){this.authTokenStore.setAuthConfig(t),this.tokenOrchestrator.setAuthConfig(t)}}const le=new Rr,Pr={identityId:"identityId"},Nr=new $("DefaultIdentityIdStore");class rn{setAuthConfig(t){he(t.Cognito),this.authConfig=t,this._authKeys=jr("Cognito",t.Cognito.identityPoolId)}constructor(t){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=t}async loadIdentityId(){var t;he((t=this.authConfig)==null?void 0:t.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const n=await this.keyValueStorage.getItem(this._authKeys.identityId);return n?(this._hasGuestIdentityId=!0,{id:n,type:"guest"}):null}}catch(n){return Nr.log("Error getting stored IdentityId.",n),null}}async storeIdentityId(t){var n;he((n=this.authConfig)==null?void 0:n.Cognito),t.type==="guest"?(this.keyValueStorage.setItem(this._authKeys.identityId,t.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=t.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const jr=(e,t)=>Ke(Pr)(`com.amplify.${e}`,t),Pe=({endpointOverride:e})=>t=>e?{url:new ve(e)}:$o(t);function an(e){const t=oe(e).payload.iss,n={};if(!t)throw new E({name:"InvalidIdTokenException",message:"Invalid Idtoken."});const s=t.replace(/(^\w+:|^)\/\//,"");return n[s]=e,n}async function Or({tokens:e,authConfig:t,identityIdStore:n}){n.setAuthConfig({Cognito:t});const s=await n.loadIdentityId();if(s)return s.id;const o=e!=null&&e.idToken?an(e.idToken.toString()):{},r=await Dr(o,t);return n.storeIdentityId({id:r,type:e?"primary":"guest"}),r}async function Dr(e,t){const n=t==null?void 0:t.identityPoolId,s=Re(n),o=Uo({endpointResolver:Pe({endpointOverride:t.identityPoolEndpoint})});let r;try{r=(await o({region:s},{IdentityPoolId:n,Logins:e})).IdentityId}catch(a){throw ie(a),new E(a)}if(!r)throw new E({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return r}const ue=new $("CognitoCredentialsProvider"),kt=50*60*1e3;class cn{constructor(t){this._nextCredentialsRefresh=0,this._identityIdStore=t}async clearCredentialsAndIdentityId(){ue.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){ue.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(t){const n=t.authenticated,{tokens:s}=t,{authConfig:o}=t;try{he(o==null?void 0:o.Cognito)}catch{return}if(!n&&!o.Cognito.allowGuestAccess)return;const{forceRefresh:r}=t,a=this.hasTokenChanged(s),c=await Or({tokens:s,authConfig:o.Cognito,identityIdStore:this._identityIdStore});return(r||a)&&this.clearCredentials(),n?(nr(s),this.credsForOIDCTokens(o.Cognito,s,c)):this.getGuestCredentials(c,o.Cognito)}async getGuestCredentials(t,n){var a,c;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!1)return ue.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const s=Re(n.identityPoolId),o=vt({endpointResolver:Pe({endpointOverride:n.identityPoolEndpoint})});let r;try{r=await o({region:s},{IdentityId:t})}catch(l){throw ie(l),new E(l)}if((a=r==null?void 0:r.Credentials)!=null&&a.AccessKeyId&&((c=r==null?void 0:r.Credentials)!=null&&c.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+kt;const l={credentials:{accessKeyId:r.Credentials.AccessKeyId,secretAccessKey:r.Credentials.SecretKey,sessionToken:r.Credentials.SessionToken,expiration:r.Credentials.Expiration},identityId:t};return r.IdentityId&&(l.identityId=r.IdentityId,this._identityIdStore.storeIdentityId({id:r.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...l,isAuthenticatedCreds:!1},l}else throw new E({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(t,n,s){var l,h,m;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!0)return ue.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const o=n.idToken?an(n.idToken.toString()):{},r=Re(t.identityPoolId),a=vt({endpointResolver:Pe({endpointOverride:t.identityPoolEndpoint})});let c;try{c=await a({region:r},{IdentityId:s,Logins:o})}catch(y){throw ie(y),new E(y)}if((l=c==null?void 0:c.Credentials)!=null&&l.AccessKeyId&&((h=c==null?void 0:c.Credentials)!=null&&h.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+kt;const y={credentials:{accessKeyId:c.Credentials.AccessKeyId,secretAccessKey:c.Credentials.SecretKey,sessionToken:c.Credentials.SessionToken,expiration:c.Credentials.Expiration},identityId:s};return c.IdentityId&&(y.identityId=c.IdentityId,this._identityIdStore.storeIdentityId({id:c.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...y,isAuthenticatedCreds:!0,associatedIdToken:(m=n.idToken)==null?void 0:m.toString()},y}else throw new E({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return this._nextCredentialsRefresh===void 0?!0:this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(t){var n,s;return!!t&&!!((n=this._credentialsAndIdentityId)!=null&&n.associatedIdToken)&&((s=t.idToken)==null?void 0:s.toString())!==this._credentialsAndIdentityId.associatedIdToken}}const Mr=new cn(new rn(be)),Lr={configure(e,t){const n=Ut(e),s=new Ho({sameSite:"lax"}),o=t!=null&&t.ssr?s:be,r=t!=null&&t.ssr?new cn(new rn(s)):Mr;if(!n.Auth){X.configure(n,t);return}if(t!=null&&t.Auth){X.configure(n,t);return}if(!X.libraryOptions.Auth){le.setAuthConfig(n.Auth),le.setKeyValueStorage(o),X.configure(n,{...t,Auth:{tokenProvider:le,credentialsProvider:r}});return}if(t){const a=X.libraryOptions.Auth;t.ssr!==void 0&&(le.setKeyValueStorage(o),a.credentialsProvider=r),X.configure(n,{Auth:a,...t});return}X.configure(n)},getConfig(){return X.getConfig()}},Ur={Auth:{Cognito:{userPoolId:"us-east-1_XXXXXXXXX",userPoolClientId:"4oc76981p9te4uegc85r0mnjg7",loginWith:{oauth:{domain:"https://us-east-1csm5oddde.auth.us-east-1.amazoncognito.com",scopes:["openid","email","profile"],redirectSignIn:["https://d1zhi8uis2cnfs.cloudfront.net/auth/callback"],redirectSignOut:["https://d1zhi8uis2cnfs.cloudfront.net/"],responseType:"code",pkce:!0}}}}};Lr.configure(Ur);ke.createRoot(document.getElementById("root")).render(i.jsx(In.StrictMode,{children:i.jsx(is,{})}));export{X as A,Kn as B,H as _,U as a,Wr as b,Nt as c,Ln as g,$r as h,Mn as i,i as j,Ye as s};
