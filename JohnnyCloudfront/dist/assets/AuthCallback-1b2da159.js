import{j as o,B as k}from"./index-e9d8c211.js";import{e as m,r as f}from"./react-vendor-cf6d7c8c.js";import"./ui-vendor-5be21587.js";function x(){const s=m();return f.useEffect(()=>{(async()=>{console.log("ğŸ”„ AuthCallback: Starting authentication process");const l=new URLSearchParams(window.location.search),a=l.get("code"),n=l.get("state")||"/";console.log("ğŸ”„ AuthCallback: Code received:",!!a),console.log("ğŸ”„ AuthCallback: State:",n);const r=sessionStorage.getItem("pkce_verifier")||"";if(console.log("ğŸ”„ AuthCallback: Verifier found:",!!r),!a||!r){console.log("âŒ AuthCallback: Missing code or verifier, redirecting to login"),s("/login",{replace:!0});return}const c="https://us-east-1csm5oddde.auth.us-east-1.amazoncognito.com",u="4oc76981p9te4uegc85r0mnjg7",d="https://d1zhi8uis2cnfs.cloudfront.net/auth/callback",i=c.startsWith("http")?`${c}/oauth2/token`:`https://${c}/oauth2/token`,h=new URLSearchParams({grant_type:"authorization_code",client_id:u,code:a,code_verifier:r,redirect_uri:d});try{console.log("ğŸ”„ AuthCallback: Making token request to:",i);const e=await fetch(i,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:h.toString()});if(console.log("ğŸ”„ AuthCallback: Token response status:",e.status),!e.ok){const g=await e.text();console.log("âŒ AuthCallback: Token request failed:",g),s("/login",{replace:!0});return}const t=await e.json();console.log("âœ… AuthCallback: Tokens received successfully"),t.id_token&&localStorage.setItem("id_token",t.id_token),t.access_token&&localStorage.setItem("access_token",t.access_token),t.refresh_token&&localStorage.setItem("refresh_token",t.refresh_token),sessionStorage.removeItem("pkce_verifier"),console.log("âœ… AuthCallback: Redirecting to:",n),s(n,{replace:!0})}catch(e){console.log("âŒ AuthCallback: Token request error:",e),s("/login",{replace:!0})}})()},[s]),o.jsxs("div",{className:"min-h-dvh relative",children:[o.jsx(k,{}),o.jsx("div",{className:"relative min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-400 mx-auto mb-4"}),o.jsx("p",{className:"text-slate-300",children:"Completing sign in..."})]})})]})}export{x as default};
