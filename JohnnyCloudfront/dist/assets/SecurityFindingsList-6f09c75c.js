import{j as t}from"./index-d7f71f52.js";import{r as n}from"./react-vendor-cf778ffd.js";import{a as j,m as y,b as w,d as N}from"./Metrics-9b30fb3e.js";import"./Heading-7a6263f9.js";import"./Button-28541fea.js";import"./ErrorBoundary-08a630ee.js";function C({findings:o,loading:d=!1}){const[c,x]=n.useState("All"),[i,m]=n.useState("All"),r=Array.isArray(o)?o:[],a=e=>e.provider==="GuardDuty"&&typeof e.severity=="number"?y(e.severity):w(e.severity.toString()),l=r.filter(e=>{const s=a(e),b=c==="All"||s===c,v=i==="All"||e.status===i;return b&&v}),h={All:r.length,High:r.filter(e=>a(e)==="High").length,Medium:r.filter(e=>a(e)==="Medium").length,Low:r.filter(e=>a(e)==="Low").length},u={All:r.length,Active:r.filter(e=>e.status==="Active").length,Suppressed:r.filter(e=>e.status==="Suppressed").length,Resolved:r.filter(e=>e.status==="Resolved").length},p=()=>{const e=l.map(s=>({timestamp_first_seen:s.firstSeen,timestamp_last_seen:s.lastSeen,provider:s.provider,severity:a(s),title:s.title,account:s.account,region:s.region,resource_id:s.resourceId,status:s.status,link:s.link||""}));N(e)};return d?t.jsx("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-[0_0_20px_rgba(0,0,0,0.25)] backdrop-blur",children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-4 bg-white/10 rounded w-48 mb-4"}),t.jsx("div",{className:"space-y-2",children:[1,2,3].map(e=>t.jsx("div",{className:"h-16 bg-white/10 rounded"},e))})]})}):t.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-[0_0_20px_rgba(0,0,0,0.25)] backdrop-blur",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsx("h3",{className:"text-sm font-medium text-slate-300",children:"Security Findings"}),t.jsx("button",{onClick:p,className:"px-3 py-1 text-xs bg-white/10 hover:bg-white/20 rounded border border-white/20 transition-colors",disabled:l.length===0,children:"Download CSV"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("div",{className:"flex gap-1 mb-2",children:["All","High","Medium","Low"].map(e=>t.jsxs("button",{onClick:()=>x(e),className:`px-3 py-1 text-xs rounded transition-colors ${c===e?"bg-cyan-500/20 text-cyan-300 border border-cyan-500/30":"bg-white/5 text-slate-300 hover:bg-white/10 border border-white/10"}`,children:[e," (",h[e],")"]},e))}),t.jsx("div",{className:"flex gap-1",children:["All","Active","Suppressed","Resolved"].map(e=>t.jsxs("button",{onClick:()=>m(e),className:`px-2 py-1 text-xs rounded transition-colors ${i===e?"bg-amber-500/20 text-amber-300 border border-amber-500/30":"bg-white/5 text-slate-400 hover:bg-white/10 border border-white/10"}`,children:[e," (",u[e],")"]},e))})]}),t.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:l.length===0?t.jsx("div",{className:"text-center py-8 text-slate-400",children:"No findings match the selected filters"}):l.map(e=>{const s=a(e);return t.jsxs("div",{className:"p-3 bg-white/5 rounded-lg border border-white/10",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"text-sm font-medium text-slate-200 mb-1",children:e.title}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[t.jsx("span",{children:e.provider}),t.jsx("span",{children:"•"}),t.jsx("span",{children:e.account}),t.jsx("span",{children:"•"}),t.jsx("span",{children:e.region})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${j(s)}`,children:s}),t.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${e.status==="Active"?"bg-red-500/20 text-red-300":e.status==="Suppressed"?"bg-amber-500/20 text-amber-300":"bg-green-500/20 text-green-300"}`,children:e.status})]})]}),t.jsxs("div",{className:"text-xs text-slate-400 mb-2",children:["Resource: ",t.jsx("span",{className:"text-slate-200",children:e.resourceId})]}),t.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[t.jsxs("span",{children:["First seen: ",new Date(e.firstSeen).toLocaleDateString()]}),t.jsxs("span",{children:["Last seen: ",new Date(e.lastSeen).toLocaleDateString()]})]}),e.link&&t.jsx("div",{className:"mt-2",children:t.jsx("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-cyan-300 hover:text-cyan-200 underline",children:"View in AWS Console"})})]},e.id)})})]})}export{C as default};
