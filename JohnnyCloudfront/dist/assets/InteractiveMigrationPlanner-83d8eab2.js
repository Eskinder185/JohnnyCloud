var j=Object.defineProperty;var S=(c,t,s)=>t in c?j(c,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[t]=s;var x=(c,t,s)=>(S(c,typeof t!="symbol"?t+"":t,s),s);import{j as e}from"./index-d7f71f52.js";import{r as h}from"./react-vendor-cf778ffd.js";const b="whyaws_planner_v1";class w{constructor(){x(this,"state");this.state=this.loadFromStorage()}loadFromStorage(){try{const t=localStorage.getItem(b);if(t){const s=JSON.parse(t);return{input:{workloads:6,dbType:"postgres",criticality:"medium",traffic:"steady",goal:"replatform",multiRegion:!1,regulated:!1,...s.input},assumptions:{downtimeCostPerHour:5e3,hoursAvoidedPerMonth:3,highSeverityExposures:12,latencyImprovement:25,...s.assumptions},savings:{rightsizingAdoption:75,idleSchedulingHours:8,includeStorageTransitions:!0,ec2MonthlyCost:2e3,s3MonthlyCost:500,...s.savings}}}}catch(t){console.error("Failed to load planner state from storage:",t)}return{input:{workloads:6,dbType:"postgres",criticality:"medium",traffic:"steady",goal:"replatform",multiRegion:!1,regulated:!1},assumptions:{downtimeCostPerHour:5e3,hoursAvoidedPerMonth:3,highSeverityExposures:12,latencyImprovement:25},savings:{rightsizingAdoption:75,idleSchedulingHours:8,includeStorageTransitions:!0,ec2MonthlyCost:2e3,s3MonthlyCost:500}}}saveToStorage(){try{localStorage.setItem(b,JSON.stringify(this.state))}catch(t){console.error("Failed to save planner state to storage:",t)}}getInput(){return this.state.input}setInput(t){this.state.input={...this.state.input,...t},this.saveToStorage()}getAssumptions(){return this.state.assumptions}setAssumptions(t){this.state.assumptions={...this.state.assumptions,...t},this.saveToStorage()}getSavings(){return this.state.savings}setSavings(t){this.state.savings={...this.state.savings,...t},this.saveToStorage()}buildPlan(t){const s=[];t.goal==="lift"&&s.push("rehost"),t.goal==="replatform"&&s.push("replatform"),t.goal==="refactor"&&s.push("refactor"),(t.dbType==="mixed"||t.criticality==="high")&&!s.includes("replatform")&&s.push("replatform"),t.traffic==="spiky"&&!s.includes("refactor")&&s.push("refactor");const i=new Set(["VPC + Subnets + NAT","ALB / NLB","CloudWatch + X-Ray + Logs","AWS Backup","Security Hub + GuardDuty","IAM Identity Center (SSO)"]);s.includes("rehost")&&i.add("EC2 + ASG"),s.includes("replatform")&&i.add("ECS on Fargate"),s.includes("refactor")&&i.add("Lambda + API Gateway + EventBridge");const l={none:"",mysql:"Amazon RDS for MySQL (Multi-AZ)",postgres:"Amazon RDS for PostgreSQL (Multi-AZ)",sqlserver:"Amazon RDS for SQL Server (Multi-AZ)",nosql:"Amazon DynamoDB",mixed:"RDS (engine-matched) + DynamoDB"};t.dbType!=="none"&&i.add(l[t.dbType]);let r=1;t.multiRegion&&(r+=1),t.regulated&&(r+=1);const o={rehost:.5,replatform:.75,refactor:1.25};let m=0;s.forEach(v=>{m+=o[v]*t.workloads});const a={high:1.3,medium:1.1,low:1}[t.criticality],n=t.traffic==="spiky"||t.traffic==="seasonal"?1.1:1,u=t.dbType!=="none"?.5:0,d=(r+m+u)*a*n,g=Math.max(3,Math.round(d*2)/2),f=[{title:"Discover & Assess",weeks:"Weeks 1–2",bullets:["Inventory apps & dependencies","Landing zone guardrails (CIS)","Choose 6R strategy per workload",t.regulated?"Compliance requirements mapping":"",t.multiRegion?"Multi-region architecture planning":""].filter(Boolean)},{title:"Landing Zone",weeks:`Weeks 2–${2+Math.ceil(r)}`,bullets:["VPC & routing setup","Observability + backups","Baseline security controls",t.multiRegion?"Cross-region connectivity":"",t.regulated?"Compliance controls implementation":""].filter(Boolean)},{title:"Pilot Migration",weeks:`Weeks ${2+Math.ceil(r)}–${4+Math.ceil(r)}`,bullets:[s.includes("rehost")?"Rehost pilot on EC2":"Containerize pilot on ECS Fargate","Cutover plan + rollback","Performance & cost validation","Security & compliance validation"]},{title:"Scale & Optimize",weeks:`Weeks ${4+Math.ceil(r)}–${g}`,bullets:["Wave-based migrations","Automate guardrails & tags","FinOps cadence (rightsizing, SPs)","Continuous optimization"]}],y=["Enable Security Hub","CloudTrail multi-region","AWS Backup configured","IAM Identity Center setup",t.regulated?"Compliance framework mapping":"",t.multiRegion?"Multi-region backup strategy":""].filter(Boolean);return{strategy:s,recommended:Array.from(i).filter(Boolean),effortWeeks:g,phases:f,prerequisites:y}}calculateBusinessImpact(t,s){const i=s.downtimeCostPerHour*s.hoursAvoidedPerMonth,l=Math.min(s.highSeverityExposures,Math.floor(s.highSeverityExposures*.7)),r=t.workloads*200,o=`${s.latencyImprovement}% faster response times`;return{avoidedDowntimeCost:i,riskReduction:l,costOptimization:r,performanceEfficiency:o}}calculateSavings(t){const s=t.ec2MonthlyCost*.25*(t.rightsizingAdoption/100),i=t.ec2MonthlyCost*.5*(t.idleSchedulingHours/24),l=t.includeStorageTransitions?t.s3MonthlyCost*.2:0;return{total:s+i+l,breakdown:{rightsizing:s,scheduling:i,storage:l}}}}const p=new w;function M({onAsk:c}){const[t,s]=h.useState(p.getInput()),[i,l]=h.useState(!1),r=h.useMemo(()=>p.buildPlan(t),[t]);h.useEffect(()=>{i&&(p.setInput(t),l(!1))},[t,i]);const o=a=>{s(n=>({...n,...a})),l(!0)},m=()=>{const a={input:t,plan:r,generatedAt:new Date().toISOString()},n=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),u=URL.createObjectURL(n),d=document.createElement("a");d.href=u,d.download=`migration-plan-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(u)};return e.jsxs("div",{className:"rounded-2xl border bg-white/5 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-semibold mb-2",children:"Migration Planner"}),e.jsx("p",{className:"opacity-80",children:"Interactive migration planning with live timeline updates"})]}),e.jsx("div",{className:"text-xs opacity-70",children:"Educational • estimates only"})]}),e.jsxs("div",{className:"grid md:grid-cols-4 lg:grid-cols-7 gap-4 mb-6",children:[e.jsxs("div",{className:"rounded-xl border border-dashed bg-white/5 p-4",children:[e.jsx("label",{className:"text-sm opacity-70 mb-2 block",children:"Workloads"}),e.jsx("input",{type:"number",min:1,max:100,value:t.workloads,onChange:a=>o({workloads:Math.max(1,Number(a.target.value))}),className:"w-full rounded border bg-transparent px-3 py-2 text-white focus:outline-none focus:border-cyan-400","aria-label":"Number of workloads to migrate"})]}),e.jsxs("div",{className:"rounded-xl border border-dashed bg-white/5 p-4",children:[e.jsx("label",{className:"text-sm opacity-70 mb-2 block",children:"Database"}),e.jsxs("select",{value:t.dbType,onChange:a=>o({dbType:a.target.value}),className:"w-full rounded border bg-transparent px-3 py-2 text-white focus:outline-none focus:border-cyan-400","aria-label":"Database type",children:[e.jsx("option",{value:"none",children:"None"}),e.jsx("option",{value:"mysql",children:"MySQL"}),e.jsx("option",{value:"postgres",children:"PostgreSQL"}),e.jsx("option",{value:"sqlserver",children:"SQL Server"}),e.jsx("option",{value:"nosql",children:"NoSQL"}),e.jsx("option",{value:"mixed",children:"Mixed"})]})]}),e.jsxs("div",{className:"rounded-xl border border-dashed bg-white/5 p-4",children:[e.jsx("label",{className:"text-sm opacity-70 mb-2 block",children:"Criticality"}),e.jsxs("select",{value:t.criticality,onChange:a=>o({criticality:a.target.value}),className:"w-full rounded border bg-transparent px-3 py-2 text-white focus:outline-none focus:border-cyan-400","aria-label":"Criticality level",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{className:"rounded-xl border border-dashed bg-white/5 p-4",children:[e.jsx("label",{className:"text-sm opacity-70 mb-2 block",children:"Traffic Pattern"}),e.jsxs("select",{value:t.traffic,onChange:a=>o({traffic:a.target.value}),className:"w-full rounded border bg-transparent px-3 py-2 text-white focus:outline-none focus:border-cyan-400","aria-label":"Traffic pattern",children:[e.jsx("option",{value:"steady",children:"Steady"}),e.jsx("option",{value:"spiky",children:"Spiky"}),e.jsx("option",{value:"seasonal",children:"Seasonal"})]})]}),e.jsxs("div",{className:"rounded-xl border border-dashed bg-white/5 p-4",children:[e.jsx("label",{className:"text-sm opacity-70 mb-2 block",children:"Strategy"}),e.jsxs("select",{value:t.goal,onChange:a=>o({goal:a.target.value}),className:"w-full rounded border bg-transparent px-3 py-2 text-white focus:outline-none focus:border-cyan-400","aria-label":"Migration strategy",children:[e.jsx("option",{value:"lift",children:"Lift & Shift"}),e.jsx("option",{value:"replatform",children:"Replatform"}),e.jsx("option",{value:"refactor",children:"Refactor"})]})]}),e.jsx("div",{className:"rounded-xl border border-dashed bg-white/5 p-4",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm opacity-70 mb-2",children:[e.jsx("input",{type:"checkbox",checked:t.multiRegion,onChange:a=>o({multiRegion:a.target.checked}),className:"rounded border-white/20 bg-transparent text-cyan-500 focus:ring-cyan-500","aria-label":"Multi-region deployment"}),"Multi-Region"]})}),e.jsx("div",{className:"rounded-xl border border-dashed bg-white/5 p-4",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm opacity-70 mb-2",children:[e.jsx("input",{type:"checkbox",checked:t.regulated,onChange:a=>o({regulated:a.target.checked}),className:"rounded border-white/20 bg-transparent text-cyan-500 focus:ring-cyan-500","aria-label":"Regulated environment"}),"Regulated"]})})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"rounded-xl border bg-white/5 p-4",children:[e.jsx("div",{className:"text-sm opacity-70 mb-2",children:"Strategy (6Rs)"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:r.strategy.map(a=>e.jsx("span",{className:"px-2 py-1 rounded-full text-xs border bg-white/5 capitalize",children:a},a))}),e.jsx("div",{className:"text-sm opacity-70",children:"Estimated effort"}),e.jsxs("div",{className:"text-2xl font-semibold text-cyan-300",children:[r.effortWeeks," weeks"]})]}),e.jsxs("div",{className:"lg:col-span-2 rounded-xl border bg-white/5 p-4",children:[e.jsx("div",{className:"text-sm opacity-70 mb-2",children:"Prerequisites"}),e.jsx("ul",{className:"list-disc list-inside text-sm opacity-90 space-y-1",children:r.prerequisites.map((a,n)=>e.jsx("li",{children:a},n))})]})]}),e.jsx("div",{className:"grid md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6",children:r.phases.map(a=>e.jsxs("div",{className:"rounded-xl border bg-white/5 p-4",children:[e.jsx("div",{className:"text-xs opacity-60 mb-1",children:a.weeks}),e.jsx("div",{className:"font-medium mb-2",children:a.title}),e.jsx("ul",{className:"list-disc list-inside text-sm opacity-90 space-y-1",children:a.bullets.map((n,u)=>e.jsx("li",{children:n},u))})]},a.title))}),e.jsxs("div",{className:"rounded-xl border bg-white/5 p-4 mb-6",children:[e.jsx("div",{className:"text-sm opacity-70 mb-2",children:"Recommended AWS Services"}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-2",children:r.recommended.map(a=>e.jsx("div",{className:"text-sm opacity-90 px-2 py-1 bg-white/5 rounded border border-white/10",children:a},a))})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("a",{href:"/guardrails",className:"px-4 py-2 rounded border hover:bg-white/5 transition-colors",children:"Open Guardrails"}),e.jsx("a",{href:"/metrics",className:"px-4 py-2 rounded border hover:bg-white/5 transition-colors",children:"Open Optimization Hub"}),e.jsx("button",{onClick:m,className:"px-4 py-2 rounded border hover:bg-white/5 transition-colors",children:"Export Plan (JSON)"}),e.jsx("button",{onClick:()=>c({migrationContext:{input:t,plan:r}}),className:"px-4 py-2 rounded bg-black text-white hover:bg-gray-800 transition-colors",children:"Ask JohnnyCloud to refine this"})]})]})}export{M as default};
